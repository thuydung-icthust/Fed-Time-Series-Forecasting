INFO logger 2024-02-04 11:44:30,132 | data_utils.py:383 | Observations info in ElBorn
INFO logger 2024-02-04 11:44:30,132 | data_utils.py:384 | 	Total number of samples:  4192
INFO logger 2024-02-04 11:44:30,133 | data_utils.py:385 | 	Number of samples for training: 3354
INFO logger 2024-02-04 11:44:30,133 | data_utils.py:386 | 	Number of samples for validation:  838
INFO logger 2024-02-04 11:44:30,135 | data_utils.py:383 | Observations info in LesCorts
INFO logger 2024-02-04 11:44:30,135 | data_utils.py:384 | 	Total number of samples:  6892
INFO logger 2024-02-04 11:44:30,135 | data_utils.py:385 | 	Number of samples for training: 5514
INFO logger 2024-02-04 11:44:30,136 | data_utils.py:386 | 	Number of samples for validation:  1378
INFO logger 2024-02-04 11:44:30,137 | data_utils.py:383 | Observations info in PobleSec
INFO logger 2024-02-04 11:44:30,138 | data_utils.py:384 | 	Total number of samples:  15927
INFO logger 2024-02-04 11:44:30,138 | data_utils.py:385 | 	Number of samples for training: 12742
INFO logger 2024-02-04 11:44:30,138 | data_utils.py:386 | 	Number of samples for validation:  3185
INFO logger 2024-02-04 11:44:30,139 | data_utils.py:389 | Observations info using all data
INFO logger 2024-02-04 11:44:30,139 | data_utils.py:390 | 	Total number of samples:  27011
INFO logger 2024-02-04 11:44:30,139 | data_utils.py:391 | 	Number of samples for training: 21610
INFO logger 2024-02-04 11:44:30,139 | data_utils.py:392 | 	Number of samples for validation:  5401
INFO logger 2024-02-04 11:44:30,139 | data_utils.py:118 | Using Flooring and Capping and with params: {'ElBorn': (10, 90), 'LesCorts': (10, 90), 'PobleSec': (5, 95)}
INFO logger 2024-02-04 11:44:30,996 | server.py:74 | Initializing client manager...
INFO logger 2024-02-04 11:44:30,997 | server.py:81 | Registering clients...
INFO logger 2024-02-04 11:44:30,997 | client_manager.py:66 | Registered client with id: ElBorn_0
INFO logger 2024-02-04 11:44:30,997 | client_manager.py:66 | Registered client with id: ElBorn_1
INFO logger 2024-02-04 11:44:30,997 | client_manager.py:66 | Registered client with id: ElBorn_2
INFO logger 2024-02-04 11:44:30,998 | client_manager.py:66 | Registered client with id: ElBorn_3
INFO logger 2024-02-04 11:44:30,998 | client_manager.py:66 | Registered client with id: ElBorn_4
INFO logger 2024-02-04 11:44:30,998 | client_manager.py:66 | Registered client with id: LesCorts_0
INFO logger 2024-02-04 11:44:30,998 | client_manager.py:66 | Registered client with id: LesCorts_1
INFO logger 2024-02-04 11:44:30,998 | client_manager.py:66 | Registered client with id: LesCorts_2
INFO logger 2024-02-04 11:44:30,999 | client_manager.py:66 | Registered client with id: LesCorts_3
INFO logger 2024-02-04 11:44:30,999 | client_manager.py:66 | Registered client with id: LesCorts_4
INFO logger 2024-02-04 11:44:30,999 | client_manager.py:66 | Registered client with id: PobleSec_0
INFO logger 2024-02-04 11:44:30,999 | client_manager.py:66 | Registered client with id: PobleSec_1
INFO logger 2024-02-04 11:44:30,999 | client_manager.py:66 | Registered client with id: PobleSec_2
INFO logger 2024-02-04 11:44:31,000 | client_manager.py:66 | Registered client with id: PobleSec_3
INFO logger 2024-02-04 11:44:31,000 | client_manager.py:66 | Registered client with id: PobleSec_4
INFO logger 2024-02-04 11:44:31,000 | server.py:85 | Client manager initialized!
INFO logger 2024-02-04 11:44:31,000 | server.py:67 | Aggregation algorithm: FedAvg()
INFO logger 2024-02-04 11:44:31,000 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['PobleSec_3']
X_val_sub.shape is 535 	 y_val_sub is 535
Clients participating training are: dict_keys(['ElBorn', 'LesCorts', 'PobleSec'])
INFO logger 2024-02-04 11:44:32,722 | server.py:99 | Starting FL rounds
INFO logger 2024-02-04 11:44:32,723 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['LesCorts_1', 'PobleSec_2', 'PobleSec_4', 'ElBorn_0', 'ElBorn_4', 'LesCorts_3', 'LesCorts_2', 'PobleSec_3', 'LesCorts_4', 'ElBorn_2', 'ElBorn_3', 'LesCorts_0', 'PobleSec_0', 'PobleSec_1', 'ElBorn_1']
Traceback (most recent call last):
  File "/home/judy/code/Fed-Time-Series-Forecasting/main.py", line 131, in <module>
    main(args)
  File "/home/judy/code/Fed-Time-Series-Forecasting/main.py", line 54, in main
    global_model, history = fit(
                            ^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/fl_trainer.py", line 137, in fit
    model_params, history = server.fit(args.fl_rounds, args.fraction, use_carbontracker=use_carbontracker,
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py", line 114, in fit
    self.fit_round(fl_round=fl_round,
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py", line 169, in fit_round
    res = self.fit_client(fl_round, client)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py", line 235, in fit_client
    fit_res = client.fit(None)
              ^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/client_proxy.py", line 37, in fit
    return self.client.fit(model)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/torch_client.py", line 117, in fit
    self.net: torch.nn.Module = train(model=self.net, train_loader=self.train_loader, test_loader=self.val_loader,
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/utils/train_utils.py", line 63, in train
    optimizer = get_optim(model, optimizer, lr)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/utils/helpers.py", line 22, in get_optim
    optimizer = torch.optim.Adam(model.parameters(), lr=lr)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/optim/adam.py", line 45, in __init__
    super().__init__(params, defaults)
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/optim/optimizer.py", line 266, in __init__
    self.add_param_group(cast(dict, param_group))
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/_compile.py", line 22, in inner
    import torch._dynamo
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/_dynamo/__init__.py", line 5, in <module>
    from .decorators import (
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/_dynamo/decorators.py", line 141, in <module>
    @_disallow_in_graph_helper(throw_if_not_allowed=False)
     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/_dynamo/decorators.py", line 110, in inner
    allowed_functions._allowed_function_ids.remove(id(fn))
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/_dynamo/allowed_functions.py", line 81, in remove
    if idx in self():
              ^^^^^^
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/_dynamo/allowed_functions.py", line 63, in __call__
    value = lazy_initializer()
            ^^^^^^^^^^^^^^^^^^
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/_dynamo/allowed_functions.py", line 226, in _allowed_function_ids
    _find_torch_objects(torch)
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/_dynamo/allowed_functions.py", line 220, in _find_torch_objects
    _find_torch_objects(obj)
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/_dynamo/allowed_functions.py", line 221, in _find_torch_objects
    elif _is_allowed_module_prefix(obj):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/_dynamo/allowed_functions.py", line 174, in _is_allowed_module_prefix
    allowed_modules_dot = tuple([x + "." for x in allowed_modules])
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/_dynamo/allowed_functions.py", line 174, in <listcomp>
    allowed_modules_dot = tuple([x + "." for x in allowed_modules])
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt