INFO logger 2024-02-03 10:23:06,597 | data_utils.py:383 | Observations info in ElBorn
INFO logger 2024-02-03 10:23:06,598 | data_utils.py:384 | 	Total number of samples:  4192
INFO logger 2024-02-03 10:23:06,598 | data_utils.py:385 | 	Number of samples for training: 3354
INFO logger 2024-02-03 10:23:06,598 | data_utils.py:386 | 	Number of samples for validation:  838
INFO logger 2024-02-03 10:23:06,599 | data_utils.py:383 | Observations info in LesCorts
INFO logger 2024-02-03 10:23:06,599 | data_utils.py:384 | 	Total number of samples:  6892
INFO logger 2024-02-03 10:23:06,599 | data_utils.py:385 | 	Number of samples for training: 5514
INFO logger 2024-02-03 10:23:06,599 | data_utils.py:386 | 	Number of samples for validation:  1378
INFO logger 2024-02-03 10:23:06,601 | data_utils.py:383 | Observations info in PobleSec
INFO logger 2024-02-03 10:23:06,601 | data_utils.py:384 | 	Total number of samples:  15927
INFO logger 2024-02-03 10:23:06,602 | data_utils.py:385 | 	Number of samples for training: 12742
INFO logger 2024-02-03 10:23:06,602 | data_utils.py:386 | 	Number of samples for validation:  3185
INFO logger 2024-02-03 10:23:06,603 | data_utils.py:389 | Observations info using all data
INFO logger 2024-02-03 10:23:06,603 | data_utils.py:390 | 	Total number of samples:  27011
INFO logger 2024-02-03 10:23:06,603 | data_utils.py:391 | 	Number of samples for training: 21610
INFO logger 2024-02-03 10:23:06,603 | data_utils.py:392 | 	Number of samples for validation:  5401
INFO logger 2024-02-03 10:23:06,603 | data_utils.py:118 | Using Flooring and Capping and with params: {'ElBorn': (10, 90), 'LesCorts': (10, 90), 'PobleSec': (5, 95)}
INFO logger 2024-02-03 10:23:07,130 | server.py:73 | Initializing client manager...
INFO logger 2024-02-03 10:23:07,131 | server.py:80 | Registering clients...
INFO logger 2024-02-03 10:23:07,131 | client_manager.py:66 | Registered client with id: ElBorn_0
INFO logger 2024-02-03 10:23:07,131 | client_manager.py:66 | Registered client with id: ElBorn_1
INFO logger 2024-02-03 10:23:07,131 | client_manager.py:66 | Registered client with id: ElBorn_2
INFO logger 2024-02-03 10:23:07,131 | client_manager.py:66 | Registered client with id: ElBorn_3
INFO logger 2024-02-03 10:23:07,131 | client_manager.py:66 | Registered client with id: ElBorn_4
INFO logger 2024-02-03 10:23:07,131 | client_manager.py:66 | Registered client with id: LesCorts_0
INFO logger 2024-02-03 10:23:07,131 | client_manager.py:66 | Registered client with id: LesCorts_1
INFO logger 2024-02-03 10:23:07,131 | client_manager.py:66 | Registered client with id: LesCorts_2
INFO logger 2024-02-03 10:23:07,131 | client_manager.py:66 | Registered client with id: LesCorts_3
INFO logger 2024-02-03 10:23:07,131 | client_manager.py:66 | Registered client with id: LesCorts_4
INFO logger 2024-02-03 10:23:07,131 | client_manager.py:66 | Registered client with id: PobleSec_0
INFO logger 2024-02-03 10:23:07,131 | client_manager.py:66 | Registered client with id: PobleSec_1
INFO logger 2024-02-03 10:23:07,132 | client_manager.py:66 | Registered client with id: PobleSec_2
INFO logger 2024-02-03 10:23:07,132 | client_manager.py:66 | Registered client with id: PobleSec_3
INFO logger 2024-02-03 10:23:07,132 | client_manager.py:66 | Registered client with id: PobleSec_4
INFO logger 2024-02-03 10:23:07,132 | server.py:84 | Client manager initialized!
INFO logger 2024-02-03 10:23:07,132 | server.py:66 | Aggregation algorithm: FedAvg()
INFO logger 2024-02-03 10:23:07,132 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['PobleSec_3']
Clients participating training are: dict_keys(['ElBorn', 'LesCorts', 'PobleSec'])
INFO logger 2024-02-03 10:23:08,236 | server.py:98 | Starting FL rounds
INFO logger 2024-02-03 10:23:08,236 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['LesCorts_1', 'PobleSec_2', 'PobleSec_4', 'ElBorn_0', 'ElBorn_4', 'LesCorts_3', 'LesCorts_2', 'PobleSec_3', 'LesCorts_4', 'ElBorn_2', 'ElBorn_3', 'LesCorts_0', 'PobleSec_0', 'PobleSec_1', 'ElBorn_1']
INFO logger 2024-02-03 10:23:08,850 | train_utils.py:153 | Best Loss: 0.0002896100798708915
INFO logger 2024-02-03 10:23:09,302 | train_utils.py:153 | Best Loss: 0.00048219764949827213
INFO logger 2024-02-03 10:23:09,881 | train_utils.py:153 | Best Loss: 0.0004605070486166111
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-03 10:23:10,124 | train_utils.py:153 | Best Loss: 0.00023076761792895298
INFO logger 2024-02-03 10:23:10,286 | train_utils.py:153 | Best Loss: 2.704441241170887e-05
INFO logger 2024-02-03 10:23:10,560 | train_utils.py:153 | Best Loss: 0.0005479677395121745
INFO logger 2024-02-03 10:23:10,796 | train_utils.py:153 | Best Loss: 0.00021486838037769
INFO logger 2024-02-03 10:23:11,254 | train_utils.py:153 | Best Loss: 0.00046282758760288006
INFO logger 2024-02-03 10:23:11,608 | train_utils.py:153 | Best Loss: 0.00017418319152461158
INFO logger 2024-02-03 10:23:11,776 | train_utils.py:153 | Best Loss: 2.86163878345925e-05
INFO logger 2024-02-03 10:23:11,980 | train_utils.py:153 | Best Loss: 0.00014342772178261895
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-03 10:23:12,249 | train_utils.py:153 | Best Loss: 0.0007241328944021846
INFO logger 2024-02-03 10:23:12,698 | train_utils.py:153 | Best Loss: 0.000442783231663657
INFO logger 2024-02-03 10:23:13,280 | train_utils.py:153 | Best Loss: 0.0004338021676136753
INFO logger 2024-02-03 10:23:13,491 | train_utils.py:153 | Best Loss: 2.6967046345957523e-05
Python 3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
Type 'copyright', 'credits' or 'license' for more information
IPython 8.17.2 -- An enhanced Interactive Python. Type '?' for help.
RNN(
  (rnn): RNN(11, 128, batch_first=True)
  (MLP_layers): Sequential(
    (0): Linear(in_features=128, out_features=5, bias=True)
  )
)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Cell In[2], line 1
----> 1 load_model_weight(cp_mod, weight)
File ~/code/Fed-Time-Series-Forecasting/ml/utils/train_utils.py:220, in load_model_weight(net, weight)
    218 index_bias = 0
    219 for p_index, p in enumerate(net.parameters()):
--> 220     p.data =  weight[index_bias:index_bias+p.numel()].view(p.size())
    221     index_bias += p.numel()
AttributeError: 'tuple' object has no attribute 'view'
([array([[-0.00057524,  0.05693126, -0.07250189, ...,  0.00157337,
           0.03446311, -0.01808868],
         [-0.01731334, -0.07279871, -0.05859599, ..., -0.03219904,
           0.04370675,  0.07709381],
         [-0.01768559,  0.06825095, -0.01328961, ..., -0.02469429,
           0.07923051, -0.04644758],
         ...,
         [ 0.01659201, -0.00703139,  0.02964853, ..., -0.02999169,
           0.06404132,  0.08323459],
         [-0.00249007, -0.04447547, -0.05473013, ...,  0.06264952,
          -0.0711377 ,  0.02128962],
         [-0.03589945,  0.04156933, -0.00637875, ...,  0.0139918 ,
           0.05851071, -0.0282824 ]], dtype=float32),
  array([[ 0.02770198, -0.04192933,  0.02392995, ...,  0.00762566,
          -0.0047178 , -0.05374292],
         [-0.03681165,  0.02819852,  0.05052539, ..., -0.05226177,
           0.01455387,  0.05047671],
         [-0.03974533,  0.04941925, -0.05760422, ...,  0.05630777,
           0.01364612,  0.06045617],
         ...,
         [ 0.01182564, -0.06104323, -0.00182971, ...,  0.02249944,
           0.04996322,  0.07025655],
         [-0.06122614,  0.03952751,  0.02264569, ..., -0.07258486,
          -0.03225891, -0.0870195 ],
         [ 0.05003237,  0.06252082,  0.03059473, ...,  0.00125613,
          -0.02773939,  0.00222516]], dtype=float32),
  array([-7.1357556e-02,  7.5996131e-02, -1.2696313e-02, -4.8332818e-02,
          8.6724972e-03,  4.3170247e-02,  6.4152613e-02,  6.3749462e-02,
         -1.9930068e-02,  1.6004100e-02,  8.4681086e-02,  4.4746444e-02,
          7.9407267e-02,  1.6671069e-02, -7.6315567e-02,  3.1394240e-02,
         -1.8803148e-02,  1.7538240e-02,  2.8229151e-02,  4.7660869e-02,
         -4.2810392e-02, -6.7303851e-02,  8.0064356e-02,  2.5916925e-02,
          3.8716495e-02,  1.8419767e-02, -1.7360104e-02, -8.2993552e-02,
          7.4253134e-02,  7.7388771e-02, -9.7115915e-03, -2.6845455e-02,
          3.4471296e-02, -8.1797138e-02,  2.1483820e-02,  7.1497262e-02,
         -2.6797097e-02, -4.3463279e-04,  4.3163702e-02, -1.3207464e-02,
         -4.9398453e-03,  3.3486456e-02, -9.3618976e-03, -4.0147924e-03,
         -1.8660491e-03,  4.5892857e-02,  8.2797632e-02,  9.0633361e-03,
          1.1091535e-02, -6.3324295e-02,  5.3256422e-02,  5.4120716e-02,
         -6.1827838e-02,  4.2514376e-02,  2.5549529e-02, -4.8686925e-02,
         -1.4935945e-02, -7.0946731e-02,  1.0435032e-02,  4.1747976e-02,
         -5.9527617e-02, -4.6611824e-03,  6.1990451e-02,  7.2125860e-02,
          5.2822459e-02, -5.0855670e-02, -3.8965032e-03, -4.2525601e-02,
          7.4926674e-02, -4.6777361e-05, -5.2476134e-02, -1.2294087e-02,
          9.6823424e-03,  2.8116031e-02, -2.0109741e-02,  3.8355563e-03,
         -7.5703539e-02, -2.3866374e-02,  5.3081781e-02,  3.6047071e-02,
          8.7864213e-02,  6.5336913e-02,  5.2666035e-02, -3.8735643e-02,
          7.2343022e-02,  6.3185133e-02, -3.7138376e-02, -3.3174392e-02,
         -4.8708070e-02, -5.1945120e-02,  3.9942600e-02, -4.2725686e-02,
          8.2672842e-02,  2.4001494e-02, -2.6039723e-03,  3.4977086e-02,
          4.8516616e-02, -1.7936546e-02, -6.7408465e-02, -8.9751184e-02,
          8.2080141e-02,  8.5958622e-02, -3.3494696e-02,  8.3625957e-02,
          3.6934342e-02, -7.2708309e-02, -9.6372599e-03, -7.1458921e-02,
          3.4647815e-02,  3.4646623e-02,  4.1539490e-02, -1.0476756e-02,
          1.0085891e-02, -5.2402638e-02, -6.5026134e-02, -3.2980569e-02,
          3.3712566e-02, -1.5357077e-02, -1.4602702e-02, -4.2105436e-02,
         -4.7439441e-02, -4.2965285e-02, -1.7368257e-02,  8.3132870e-02,
         -2.1835273e-02, -9.3947807e-03, -5.2365765e-02, -4.8532948e-02],
        dtype=float32),
  array([-8.07793438e-02, -5.24851307e-02, -1.94813926e-02, -2.32950579e-02,
         -6.08482733e-02, -1.45342136e-02,  7.29583129e-02, -6.29687607e-02,
          5.15127331e-02, -7.20721185e-02,  1.95677467e-02, -1.87698670e-03,
         -7.98106864e-02, -4.39021774e-02, -3.33875716e-02, -6.21189140e-02,
          1.00899301e-02, -6.85900822e-02,  7.60557204e-02,  2.81231990e-03,
         -6.82768673e-02, -3.70407812e-02,  7.63089582e-02, -7.30808461e-05,
          3.69370431e-02,  5.50656877e-02, -4.66525108e-02,  7.42443651e-02,
         -5.17551750e-02, -8.00515339e-02,  4.57005836e-02, -7.08943382e-02,
         -6.44224584e-02, -6.64021373e-02,  2.79336777e-02, -8.41476303e-03,
          7.23524615e-02, -3.43500562e-02,  3.53188952e-03,  4.04936485e-02,
         -1.75596662e-02, -8.65936046e-04, -5.87381795e-02,  4.87486944e-02,
          3.66350524e-02, -1.89019088e-02, -3.61959711e-02,  6.00236058e-02,
         -7.94121772e-02,  3.66743170e-02,  6.57157600e-02, -2.54891831e-02,
          3.77021134e-02,  1.43682286e-02,  1.35036875e-02, -3.24181803e-02,
         -1.32308416e-02, -5.40549168e-03,  3.25289406e-02, -9.02151614e-02,
         -2.89631519e-03,  2.98659857e-02,  1.90533530e-02, -4.36724760e-02,
         -3.52113433e-02,  5.10958582e-02,  1.87399145e-02,  8.79579261e-02,
         -3.58383246e-02,  4.50597480e-02, -1.01007745e-02,  1.39797945e-02,
          2.80300598e-03, -8.55647177e-02,  2.91894041e-02,  1.31957810e-02,
         -6.94369674e-02, -1.64182085e-04,  2.07727868e-02,  7.08867833e-02,
          8.87678936e-02, -2.09411122e-02, -8.81756097e-03, -1.56078953e-02,
         -7.24788904e-02,  4.57902923e-02,  8.10799822e-02,  8.37435350e-02,
         -8.18323344e-02, -7.74734020e-02, -5.29577956e-02, -1.26279667e-02,
         -1.83268320e-02, -7.89248347e-02, -8.11683312e-02, -6.28034920e-02,
         -2.67018545e-02, -1.83010439e-03,  8.58700424e-02, -8.68052989e-02,
          5.40025085e-02, -3.28159034e-02,  8.70962366e-02, -6.81375787e-02,
         -7.62804896e-02, -8.91408511e-03,  4.05472890e-02, -6.39544204e-02,
         -2.43726987e-02, -6.61921799e-02,  4.99992371e-02, -4.89477441e-02,
         -4.54678908e-02, -7.56107047e-02,  3.49562131e-02,  7.94031247e-02,
          2.40437239e-02,  3.55484560e-02,  7.27369115e-02,  1.75062785e-04,
         -3.75021016e-03,  7.88459331e-02, -2.87948679e-02, -8.04543644e-02,
          1.21371467e-02,  3.99232917e-02,  2.32486445e-02,  7.09233359e-02],
        dtype=float32),
  array([[-0.11116398,  0.21316586,  0.09705697, -0.05852816, -0.13403761,
          -0.09936207, -0.04882705,  0.18080792, -0.08775841,  0.01860055,
           0.13213377, -0.00377667,  0.1054881 , -0.1082412 , -0.00155016,
           0.01654769,  0.1291355 ,  0.17174657, -0.13367297, -0.05129653,
          -0.13731508,  0.18669134,  0.18242909,  0.15444162,  0.07688866,
          -0.05586623,  0.06720164, -0.1656691 ,  0.0045521 , -0.11751534,
          -0.15489587, -0.20110162,  0.07779791,  0.1448761 , -0.0579641 ,
          -0.189608  , -0.06889815,  0.07758829,  0.18094723,  0.12247207,
          -0.07030129,  0.18951112,  0.11387166,  0.0078102 ,  0.14916022,
          -0.12673512,  0.01747724,  0.02196647, -0.00842447,  0.15367502,
           0.12083778,  0.05410244,  0.05813004, -0.13569187,  0.16881719,
          -0.00607972, -0.09904315,  0.04677628, -0.0789392 ,  0.02540574,
           0.007755  ,  0.03262891,  0.14289421,  0.14157969,  0.1787673 ,
          -0.1524106 , -0.02440226, -0.04629372, -0.06576718, -0.20225412,
           0.13824365, -0.00857619,  0.16746525,  0.20516498,  0.08402798,
          -0.05588167,  0.18489072,  0.11630526,  0.13042241, -0.03179776,
           0.05180984, -0.16579407,  0.1660463 ,  0.1739507 , -0.01685284,
          -0.01662633, -0.01694997,  0.05941072,  0.00424547, -0.18706733,
          -0.03037399, -0.0842059 ,  0.13624431, -0.14744116, -0.17046992,
           0.16119218, -0.16770427,  0.10513334, -0.04722422, -0.20745547,
          -0.19296567,  0.000694  , -0.02266268,  0.07060982,  0.02857582,
          -0.11246183,  0.17330357, -0.02070123,  0.05311465, -0.09075339,
          -0.04315814, -0.10924754, -0.1294054 , -0.14886786,  0.09239953,
           0.11837631,  0.09625241, -0.21647142,  0.00770535, -0.2102465 ,
          -0.08945148,  0.01299307,  0.12414912, -0.07321244,  0.12090327,
           0.08308442,  0.01220441,  0.19943507],
         [-0.06118053,  0.05465747, -0.08286682, -0.00345829,  0.07074777,
          -0.21531917,  0.15674436,  0.10222229, -0.07295205, -0.13940634,
          -0.08970606,  0.07753452, -0.19983567, -0.10306077, -0.1544099 ,
           0.17868131,  0.12174828, -0.21037598, -0.17080869, -0.10937032,
           0.16464177,  0.1610788 ,  0.11858234,  0.06080027, -0.15757887,
          -0.02676105,  0.19569722, -0.12019704, -0.05311669,  0.13696824,
          -0.04670113, -0.11271445, -0.1445591 , -0.12892829, -0.18768482,
          -0.02436762,  0.01020355,  0.12513064, -0.10901561, -0.04998377,
          -0.1461653 ,  0.20231357,  0.0010156 , -0.21137983,  0.10550539,
           0.12458974,  0.13455501,  0.21584691, -0.04917407,  0.05064931,
           0.16327304,  0.04607038, -0.03519461,  0.03964502, -0.06100061,
           0.15484844,  0.08874959,  0.12374908,  0.07683863,  0.07389139,
           0.00982954, -0.10129868,  0.00354292,  0.08863202, -0.11818096,
           0.21906157,  0.15874606, -0.12426792, -0.14345668,  0.05011042,
          -0.15688173,  0.08312989,  0.13189095,  0.09968002,  0.02717174,
          -0.10377958, -0.19009049,  0.06369957,  0.16176277, -0.00232626,
          -0.00154707, -0.08152609,  0.0063479 , -0.09071121, -0.16448829,
           0.03027353, -0.0684123 , -0.12161051, -0.17622866, -0.06935197,
           0.02315094, -0.16491434,  0.04360313, -0.07544278,  0.08168614,
           0.08203956, -0.03900556, -0.20707816, -0.06054072, -0.18151881,
           0.0246879 , -0.2098544 , -0.17092115,  0.10985885, -0.11281345,
           0.04758273,  0.17299005, -0.1704255 , -0.1872333 , -0.16364369,
           0.09839507,  0.19972137,  0.02796826, -0.17025197, -0.12464275,
          -0.07968921, -0.20129123,  0.08274728,  0.14539441,  0.17257485,
          -0.20299058,  0.0767695 , -0.03174165, -0.20961249,  0.1242946 ,
           0.12181637, -0.00792128, -0.0038818 ],
         [-0.137687  ,  0.12095723, -0.05333497, -0.00379999,  0.16309084,
          -0.125224  ,  0.2009592 ,  0.12101165, -0.11684395, -0.13587536,
          -0.17385656,  0.12970687,  0.00922893, -0.03211482,  0.15953647,
          -0.0537131 ,  0.07648856,  0.03685639, -0.01365584, -0.11160078,
          -0.13663241, -0.18210374,  0.17652836,  0.20177591,  0.21344115,
           0.10877223, -0.05133395, -0.12415233, -0.2122024 , -0.08122487,
          -0.15495767, -0.05272911, -0.14879446, -0.1511564 , -0.00681158,
          -0.15505864,  0.02004858, -0.00866647,  0.18719007,  0.12323712,
           0.07367998, -0.12972149,  0.05090006, -0.12128627,  0.12509182,
           0.19501224, -0.15434583,  0.19095129, -0.1288718 , -0.1006517 ,
          -0.12150966,  0.06818612, -0.19170746, -0.13719934,  0.04058069,
          -0.10116113,  0.16860664, -0.02000986,  0.08525584,  0.07797841,
          -0.13407835,  0.1840337 ,  0.1359251 ,  0.06867006, -0.2012414 ,
           0.20498283, -0.14165185,  0.18036464,  0.19942692, -0.00023037,
           0.07989629, -0.1608757 ,  0.1474433 ,  0.01870412,  0.04952576,
          -0.04059974,  0.14428182, -0.16076791,  0.03161604,  0.08140676,
           0.12905645, -0.10441195,  0.0333732 ,  0.05951929, -0.1053995 ,
          -0.08840539,  0.03617516, -0.09346138,  0.22311291,  0.05359924,
          -0.06060369,  0.05413874, -0.09403833, -0.01980001,  0.05560127,
           0.08441325,  0.02926906, -0.00746091, -0.08611859, -0.19003749,
           0.1635776 , -0.05014759, -0.19167778,  0.15672481,  0.17139438,
          -0.05308838,  0.00528703, -0.14277872,  0.12282841, -0.16213912,
           0.14788558,  0.06837264,  0.17800035, -0.11797191, -0.01971906,
           0.00424352,  0.06828845,  0.05318783,  0.03809745,  0.22438258,
           0.04766754, -0.11911655, -0.09885912,  0.10704748,  0.19259655,
          -0.19326049, -0.18068998, -0.16190402],
         [ 0.15265784, -0.1215568 ,  0.11762752, -0.09233417,  0.13719559,
          -0.01265922, -0.06061216,  0.14090087,  0.2118726 , -0.09248033,
           0.1601057 , -0.18078107, -0.15254073,  0.0003175 ,  0.1727925 ,
           0.00430508,  0.16412264,  0.12802772,  0.13893448,  0.06934185,
          -0.20974363, -0.16386771, -0.17544155,  0.04456103,  0.03696377,
           0.03659687, -0.19512433,  0.0631377 , -0.11888795, -0.20407282,
           0.05974004, -0.0007618 , -0.16472985, -0.00046753,  0.09883037,
          -0.19525336,  0.0075682 ,  0.16271663,  0.17149527, -0.07902869,
          -0.06728866, -0.12316482, -0.16594729, -0.1087169 ,  0.14641222,
           0.15738732, -0.07865982,  0.02648675, -0.13282295, -0.02342804,
           0.13878956,  0.13924104, -0.04331796, -0.15987425,  0.00175087,
          -0.11054499,  0.05384517,  0.18617237,  0.00801304, -0.03046765,
          -0.04313075, -0.00943743,  0.05863657,  0.00369729, -0.181337  ,
           0.20110823, -0.12386976,  0.21254112, -0.00691646, -0.01250648,
           0.10431571, -0.09684143, -0.00491742, -0.07310168, -0.13661025,
           0.14213632,  0.15359724,  0.09064078,  0.21454325,  0.11288914,
           0.1873717 , -0.04698921,  0.14682452,  0.04481898,  0.00718135,
           0.16083066, -0.16748886, -0.01870777, -0.10000686,  0.20389509,
          -0.03173055,  0.07043266,  0.15849902,  0.10388376, -0.0891028 ,
          -0.00296975,  0.13781159, -0.0877548 ,  0.00543697, -0.16628727,
           0.04961654,  0.13854198,  0.0088528 ,  0.01968987,  0.17138137,
           0.00217351, -0.0879005 ,  0.15786386, -0.14045742,  0.09235168,
           0.14015952,  0.00541594, -0.21919863,  0.09392621,  0.1276301 ,
          -0.02195637,  0.14944196,  0.08030103,  0.03469814,  0.18719617,
          -0.10929149,  0.03571647, -0.15193371,  0.18968625,  0.06299562,
           0.19584568, -0.16051196,  0.17102906],
         [ 0.13414268,  0.17888017, -0.08035585, -0.17853802, -0.05091246,
           0.16784647,  0.20769696, -0.00481888,  0.03759507, -0.01292568,
          -0.01168941,  0.03445191,  0.10182972, -0.05078785, -0.16648182,
          -0.01916841,  0.1131221 , -0.17230171,  0.20343484,  0.07817005,
           0.10596439,  0.11474962,  0.1547174 ,  0.19696645, -0.0881879 ,
           0.06260415,  0.12717956, -0.20835975,  0.12072697, -0.2053828 ,
          -0.148618  , -0.12029523, -0.14504433, -0.15157412,  0.12461253,
          -0.19232976, -0.10696853, -0.19959028, -0.07175392,  0.00295252,
           0.05320724, -0.09788547,  0.04510423,  0.10091279,  0.17179613,
          -0.04139682, -0.13208513,  0.13807517, -0.07473204, -0.21569753,
          -0.08247127, -0.03299787,  0.03965245,  0.1544138 ,  0.14140801,
          -0.08765449,  0.17233242,  0.07772811,  0.05741184, -0.16616826,
          -0.03386993,  0.08041731, -0.06434134,  0.08287466,  0.09169012,
          -0.14808637,  0.1689264 ,  0.02598144, -0.01033611, -0.01504749,
          -0.02640442, -0.02691785, -0.06553673,  0.03476404, -0.05239004,
           0.16042294, -0.07467985, -0.18604784,  0.20676672,  0.11797044,
          -0.14948808,  0.17535008, -0.17080605, -0.10952963, -0.11002496,
           0.05093067,  0.06914063, -0.07813796, -0.06049923, -0.11199531,
           0.1741127 ,  0.10937409,  0.01626756,  0.00659727,  0.01078088,
          -0.04857489, -0.10225543,  0.1828835 , -0.08033066, -0.13197549,
          -0.01715481,  0.06510157, -0.16876347,  0.06019396, -0.00870355,
          -0.10131717,  0.03006324,  0.02347429, -0.21737471,  0.11425798,
           0.06946768, -0.1269356 ,  0.06264416, -0.1208271 ,  0.1531443 ,
          -0.08782367,  0.06479724,  0.0659539 , -0.02368796, -0.10349089,
           0.09463026,  0.05682904, -0.0954082 , -0.04519755,  0.08380349,
          -0.17794792,  0.022714  ,  0.0534092 ]], dtype=float32),
  array([ 0.00635048,  0.00539778, -0.00026045,  0.00573479, -0.0003824 ],
        dtype=float32)],
 1100)
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Cell In[4], line 1
----> 1 weight.shape
AttributeError: 'tuple' object has no attribute 'shape'
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Cell In[5], line 1
----> 1 weight[0].shape
AttributeError: 'list' object has no attribute 'shape'
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Cell In[6], line 1
----> 1 load_model_weight(cp_mod, weight)
File ~/code/Fed-Time-Series-Forecasting/ml/utils/train_utils.py:220, in load_model_weight(net, weight)
    218 index_bias = 0
    219 for p_index, p in enumerate(net.parameters()):
--> 220     p.data =  weight[index_bias:index_bias+p.numel()].view(p.size())
    221     index_bias += p.numel()
AttributeError: 'tuple' object has no attribute 'view'
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
File ~/code/Fed-Time-Series-Forecasting/main.py:122
    119     args.outlier_columns = outlier_columns
    120     args.outlier_kwargs = outlier_kwargs
--> 122 main(args)
File ~/code/Fed-Time-Series-Forecasting/main.py:46, in main(args)
     41 # federated local params
     42 local_train_params = {"epochs": args.epochs, "optimizer": args.optimizer, "lr": args.lr,
     43                     "criterion": args.criterion, "early_stopping": args.local_early_stopping,
     44                     "patience": args.local_patience, "device": args.device
     45                     }
---> 46 global_model, history = fit(
     47                             model,
     48                             client_X_train,
     49                             client_y_train,
     50                             client_X_val,
     51                             client_y_val,
     52                             local_train_params=local_train_params,
     53                             args = args,
     54                             wandb_ins=wandb_instance)
File ~/code/Fed-Time-Series-Forecasting/fl_trainer.py:135, in fit(model, X_train, y_train, X_val, y_val, exogenous_data_train, exogenous_data_val, idxs, log_per, client_creation_fn, local_train_params, aggregation_params, use_carbontracker, args, wandb_ins)
    124 server = Server(
    125     client_proxies=client_proxies, # the client representations
    126     aggregation=args.aggregation, # the aggregation algorithm
   (...)
    130     model=copy.deepcopy(model)
    131 )
    132 # Note that the client manager instance will be initialized automatically. You can define your own client manager.
    133
    134 # train with FL
--> 135 model_params, history = server.fit(args.fl_rounds, args.fraction, use_carbontracker=use_carbontracker,
    136                                    wandb_ins=wandb_ins)
    138 params_dict = zip(model.state_dict().keys(), model_params)
    139 state_dict = OrderedDict({k: torch.Tensor(v) for k, v in params_dict})
File ~/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py:113, in Server.fit(self, num_rounds, fraction, fraction_args, use_carbontracker, wandb_ins)
    111     cb_tracker.epoch_start()
    112 # train and replace the previous global model
--> 113 self.fit_round(fl_round=fl_round,
    114                fraction=fraction,
    115                fraction_args=fraction_args,
    116                history=history)
    117 if use_carbontracker and cb_tracker is not None:
    118     cb_tracker.epoch_end()
File ~/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py:184, in Server.fit_round(self, fl_round, fraction, fraction_args, history)
    181 history.add_local_test_loss(test_losses, fl_round)
    182 history.add_local_test_metrics(all_test_metrics, fl_round)
--> 184 # Conduct defense before aggregation
    185 self.conduct_defense(model_vec_list)
    186 # STEP 4: Aggregate local models
File ~/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py:212, in conduct_defense(self, local_weights)
    210     cp_mod = copy.deepcopy(self.model_in)
    211     import IPython
--> 212     IPython.embed()
    213     load_model_weight(cp_mod, weight)
    215 net_list = [load]
File ~/code/Fed-Time-Series-Forecasting/ml/utils/train_utils.py:220, in load_model_weight(net, weight)
    218 index_bias = 0
    219 for p_index, p in enumerate(net.parameters()):
--> 220     p.data =  weight[index_bias:index_bias+p.numel()].view(p.size())
    221     index_bias += p.numel()
AttributeError: 'tuple' object has no attribute 'view'