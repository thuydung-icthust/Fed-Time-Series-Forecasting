INFO logger 2024-02-04 09:54:03,757 | data_utils.py:383 | Observations info in ElBorn
INFO logger 2024-02-04 09:54:03,757 | data_utils.py:384 | 	Total number of samples:  4192
INFO logger 2024-02-04 09:54:03,758 | data_utils.py:385 | 	Number of samples for training: 3354
INFO logger 2024-02-04 09:54:03,758 | data_utils.py:386 | 	Number of samples for validation:  838
INFO logger 2024-02-04 09:54:03,760 | data_utils.py:383 | Observations info in LesCorts
INFO logger 2024-02-04 09:54:03,761 | data_utils.py:384 | 	Total number of samples:  6892
INFO logger 2024-02-04 09:54:03,761 | data_utils.py:385 | 	Number of samples for training: 5514
INFO logger 2024-02-04 09:54:03,761 | data_utils.py:386 | 	Number of samples for validation:  1378
INFO logger 2024-02-04 09:54:03,764 | data_utils.py:383 | Observations info in PobleSec
INFO logger 2024-02-04 09:54:03,764 | data_utils.py:384 | 	Total number of samples:  15927
INFO logger 2024-02-04 09:54:03,765 | data_utils.py:385 | 	Number of samples for training: 12742
INFO logger 2024-02-04 09:54:03,765 | data_utils.py:386 | 	Number of samples for validation:  3185
INFO logger 2024-02-04 09:54:03,766 | data_utils.py:389 | Observations info using all data
INFO logger 2024-02-04 09:54:03,767 | data_utils.py:390 | 	Total number of samples:  27011
INFO logger 2024-02-04 09:54:03,767 | data_utils.py:391 | 	Number of samples for training: 21610
INFO logger 2024-02-04 09:54:03,767 | data_utils.py:392 | 	Number of samples for validation:  5401
INFO logger 2024-02-04 09:54:03,767 | data_utils.py:118 | Using Flooring and Capping and with params: {'ElBorn': (10, 90), 'LesCorts': (10, 90), 'PobleSec': (5, 95)}
INFO logger 2024-02-04 09:54:04,542 | server.py:74 | Initializing client manager...
INFO logger 2024-02-04 09:54:04,542 | server.py:81 | Registering clients...
INFO logger 2024-02-04 09:54:04,542 | client_manager.py:66 | Registered client with id: ElBorn_0
INFO logger 2024-02-04 09:54:04,542 | client_manager.py:66 | Registered client with id: ElBorn_1
INFO logger 2024-02-04 09:54:04,542 | client_manager.py:66 | Registered client with id: ElBorn_2
INFO logger 2024-02-04 09:54:04,542 | client_manager.py:66 | Registered client with id: ElBorn_3
INFO logger 2024-02-04 09:54:04,542 | client_manager.py:66 | Registered client with id: ElBorn_4
INFO logger 2024-02-04 09:54:04,542 | client_manager.py:66 | Registered client with id: LesCorts_0
INFO logger 2024-02-04 09:54:04,543 | client_manager.py:66 | Registered client with id: LesCorts_1
INFO logger 2024-02-04 09:54:04,543 | client_manager.py:66 | Registered client with id: LesCorts_2
INFO logger 2024-02-04 09:54:04,543 | client_manager.py:66 | Registered client with id: LesCorts_3
INFO logger 2024-02-04 09:54:04,543 | client_manager.py:66 | Registered client with id: LesCorts_4
INFO logger 2024-02-04 09:54:04,543 | client_manager.py:66 | Registered client with id: PobleSec_0
INFO logger 2024-02-04 09:54:04,543 | client_manager.py:66 | Registered client with id: PobleSec_1
INFO logger 2024-02-04 09:54:04,543 | client_manager.py:66 | Registered client with id: PobleSec_2
INFO logger 2024-02-04 09:54:04,543 | client_manager.py:66 | Registered client with id: PobleSec_3
INFO logger 2024-02-04 09:54:04,543 | client_manager.py:66 | Registered client with id: PobleSec_4
INFO logger 2024-02-04 09:54:04,543 | server.py:85 | Client manager initialized!
INFO logger 2024-02-04 09:54:04,543 | server.py:67 | Aggregation algorithm: FedAvg()
INFO logger 2024-02-04 09:54:04,543 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['PobleSec_3']
X_val_sub.shape is 535 	 y_val_sub is 535
Clients participating training are: dict_keys(['ElBorn', 'LesCorts', 'PobleSec'])
INFO logger 2024-02-04 09:54:06,152 | server.py:99 | Starting FL rounds
INFO logger 2024-02-04 09:54:06,153 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['LesCorts_1', 'PobleSec_2', 'PobleSec_4', 'ElBorn_0', 'ElBorn_4', 'LesCorts_3', 'LesCorts_2', 'PobleSec_3', 'LesCorts_4', 'ElBorn_2', 'ElBorn_3', 'LesCorts_0', 'PobleSec_0', 'PobleSec_1', 'ElBorn_1']
INFO logger 2024-02-04 09:54:07,238 | train_utils.py:153 | Best Loss: 0.0002896100798708915
INFO logger 2024-02-04 09:54:08,242 | train_utils.py:153 | Best Loss: 0.00048219764949827213
[31mStarting poisoning...!
INFO logger 2024-02-04 09:54:09,583 | train_utils.py:153 | Best Loss: 0.0004605070486166111
INFO logger 2024-02-04 09:54:09,995 | train_utils.py:153 | Best Loss: 0.0002248865115829712
INFO logger 2024-02-04 09:54:10,187 | train_utils.py:153 | Best Loss: 2.704441241170887e-05
INFO logger 2024-02-04 09:54:10,615 | train_utils.py:153 | Best Loss: 0.0005417556082557516
INFO logger 2024-02-04 09:54:11,201 | train_utils.py:153 | Best Loss: 0.00021486838037769
[31mStarting poisoning...!
INFO logger 2024-02-04 09:54:12,495 | train_utils.py:153 | Best Loss: 0.00046282758760288006
INFO logger 2024-02-04 09:54:13,047 | train_utils.py:153 | Best Loss: 0.00017418319152461158
INFO logger 2024-02-04 09:54:13,309 | train_utils.py:153 | Best Loss: 2.86163878345925e-05
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-04 09:54:13,721 | train_utils.py:153 | Best Loss: 0.0001446908842637271
INFO logger 2024-02-04 09:54:14,461 | train_utils.py:153 | Best Loss: 0.0007182669863976234
INFO logger 2024-02-04 09:54:15,105 | train_utils.py:153 | Best Loss: 0.000442783231663657
INFO logger 2024-02-04 09:54:16,305 | train_utils.py:153 | Best Loss: 0.0004338021676136753
INFO logger 2024-02-04 09:54:16,731 | train_utils.py:153 | Best Loss: 2.6967046345957523e-05
Traceback (most recent call last):
  File "/home/judy/code/Fed-Time-Series-Forecasting/main.py", line 131, in <module>
    main(args)
  File "/home/judy/code/Fed-Time-Series-Forecasting/main.py", line 54, in main
    global_model, history = fit(
                            ^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/fl_trainer.py", line 137, in fit
    model_params, history = server.fit(args.fl_rounds, args.fraction, use_carbontracker=use_carbontracker,
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py", line 114, in fit
    self.fit_round(fl_round=fl_round,
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py", line 186, in fit_round
    verifier_w = self.conduct_defense(model_vec_list)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py", line 225, in conduct_defense
    verifier_w = sat_verifier(preds, y_true, 0)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/verifier.py", line 116, in sat_verifier
    r_a = verify(preds_by_feat)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/verifier.py", line 45, in verify
    LB, UB = get_range_by_interval(preds[i])
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/verifier.py", line 25, in get_range_by_interval
    local_max, local_min = get_local_range(interval_preds)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/verifier.py", line 7, in get_local_range
    return np.max(preds), np.min(preds)
           ^^^^^^^^^^^^^
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 2810, in max
    return _wrapreduction(a, np.maximum, 'max', axis, None, out,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/numpy/core/fromnumeric.py", line 88, in _wrapreduction
    return ufunc.reduce(obj, axis, dtype, out, **passkwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
ValueError: zero-size array to reduction operation maximum which has no identity
Preds shape is: (15, 535, 5)
Preds shape by feat is: (15, 535)
end_idx: 5
end_idx: 10
end_idx: 15
end_idx: 20
end_idx: 25
end_idx: 30
end_idx: 35
end_idx: 40
end_idx: 45
end_idx: 50
end_idx: 55
end_idx: 60
end_idx: 65
end_idx: 70
end_idx: 75
end_idx: 80
end_idx: 85
end_idx: 90
end_idx: 95
end_idx: 100
end_idx: 105
end_idx: 110
end_idx: 115
end_idx: 120
end_idx: 125
end_idx: 130
end_idx: 135
end_idx: 140
end_idx: 145
end_idx: 150
end_idx: 155
end_idx: 160
end_idx: 165
end_idx: 170
end_idx: 175
end_idx: 180
end_idx: 185
end_idx: 190
end_idx: 195
end_idx: 200
end_idx: 205
end_idx: 210
end_idx: 215
end_idx: 220
end_idx: 225
end_idx: 230
end_idx: 235
end_idx: 240
end_idx: 245
end_idx: 250
end_idx: 255
end_idx: 260
end_idx: 265
end_idx: 270
end_idx: 275
end_idx: 280
end_idx: 285
end_idx: 290
end_idx: 295
end_idx: 300
end_idx: 305
end_idx: 310
end_idx: 315
end_idx: 320
end_idx: 325
end_idx: 330
end_idx: 335
end_idx: 340
end_idx: 345
end_idx: 350
end_idx: 355
end_idx: 360
end_idx: 365
end_idx: 370
end_idx: 375
end_idx: 380
end_idx: 385
end_idx: 390
end_idx: 395
end_idx: 400
end_idx: 405
end_idx: 410
end_idx: 415
end_idx: 420
end_idx: 425
end_idx: 430
end_idx: 435
end_idx: 440
end_idx: 445
end_idx: 450
end_idx: 455
end_idx: 460
end_idx: 465
end_idx: 470
end_idx: 475
end_idx: 480
end_idx: 485
end_idx: 490
end_idx: 495
end_idx: 500
end_idx: 505
end_idx: 510
end_idx: 515
end_idx: 520
end_idx: 525
end_idx: 530
end_idx: 535
end_idx: 535