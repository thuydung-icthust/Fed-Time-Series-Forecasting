INFO logger 2024-02-12 21:41:43,888 | data_utils.py:383 | Observations info in ElBorn
INFO logger 2024-02-12 21:41:43,891 | data_utils.py:384 | 	Total number of samples:  4192
INFO logger 2024-02-12 21:41:43,891 | data_utils.py:385 | 	Number of samples for training: 3354
INFO logger 2024-02-12 21:41:43,892 | data_utils.py:386 | 	Number of samples for validation:  838
INFO logger 2024-02-12 21:41:43,894 | data_utils.py:383 | Observations info in LesCorts
INFO logger 2024-02-12 21:41:43,894 | data_utils.py:384 | 	Total number of samples:  6892
INFO logger 2024-02-12 21:41:43,895 | data_utils.py:385 | 	Number of samples for training: 5514
INFO logger 2024-02-12 21:41:43,895 | data_utils.py:386 | 	Number of samples for validation:  1378
INFO logger 2024-02-12 21:41:43,898 | data_utils.py:383 | Observations info in PobleSec
INFO logger 2024-02-12 21:41:43,898 | data_utils.py:384 | 	Total number of samples:  15927
INFO logger 2024-02-12 21:41:43,899 | data_utils.py:385 | 	Number of samples for training: 12742
INFO logger 2024-02-12 21:41:43,899 | data_utils.py:386 | 	Number of samples for validation:  3185
INFO logger 2024-02-12 21:41:43,905 | data_utils.py:389 | Observations info using all data
INFO logger 2024-02-12 21:41:43,908 | data_utils.py:390 | 	Total number of samples:  27011
INFO logger 2024-02-12 21:41:43,908 | data_utils.py:391 | 	Number of samples for training: 21610
INFO logger 2024-02-12 21:41:43,909 | data_utils.py:392 | 	Number of samples for validation:  5401
INFO logger 2024-02-12 21:41:43,909 | data_utils.py:118 | Using Flooring and Capping and with params: {'ElBorn': (10, 90), 'LesCorts': (10, 90), 'PobleSec': (5, 95)}
X_val_sub.shape is 535 	 y_val_sub is 535
Clients participating training are: dict_keys(['ElBorn', 'LesCorts', 'PobleSec'])
INFO logger 2024-02-12 21:41:45,980 | server.py:74 | Initializing client manager...
INFO logger 2024-02-12 21:41:45,986 | server.py:81 | Registering clients...
INFO logger 2024-02-12 21:41:45,987 | client_manager.py:66 | Registered client with id: ElBorn_0
INFO logger 2024-02-12 21:41:45,987 | client_manager.py:66 | Registered client with id: ElBorn_1
INFO logger 2024-02-12 21:41:45,987 | client_manager.py:66 | Registered client with id: ElBorn_2
INFO logger 2024-02-12 21:41:45,988 | client_manager.py:66 | Registered client with id: ElBorn_3
INFO logger 2024-02-12 21:41:45,988 | client_manager.py:66 | Registered client with id: ElBorn_4
INFO logger 2024-02-12 21:41:45,988 | client_manager.py:66 | Registered client with id: LesCorts_0
INFO logger 2024-02-12 21:41:45,988 | client_manager.py:66 | Registered client with id: LesCorts_1
INFO logger 2024-02-12 21:41:45,988 | client_manager.py:66 | Registered client with id: LesCorts_2
INFO logger 2024-02-12 21:41:45,989 | client_manager.py:66 | Registered client with id: LesCorts_3
INFO logger 2024-02-12 21:41:45,989 | client_manager.py:66 | Registered client with id: LesCorts_4
INFO logger 2024-02-12 21:41:45,989 | client_manager.py:66 | Registered client with id: PobleSec_0
INFO logger 2024-02-12 21:41:45,989 | client_manager.py:66 | Registered client with id: PobleSec_1
INFO logger 2024-02-12 21:41:45,990 | client_manager.py:66 | Registered client with id: PobleSec_2
INFO logger 2024-02-12 21:41:45,990 | client_manager.py:66 | Registered client with id: PobleSec_3
INFO logger 2024-02-12 21:41:45,990 | client_manager.py:66 | Registered client with id: PobleSec_4
INFO logger 2024-02-12 21:41:45,990 | server.py:85 | Client manager initialized!
INFO logger 2024-02-12 21:41:45,991 | server.py:67 | Aggregation algorithm: FedAvg()
INFO logger 2024-02-12 21:41:45,991 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['PobleSec_3']
INFO logger 2024-02-12 21:41:48,824 | server.py:99 | Starting FL rounds
INFO logger 2024-02-12 21:41:48,825 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['LesCorts_1', 'PobleSec_2', 'PobleSec_4', 'ElBorn_0', 'ElBorn_4', 'LesCorts_3', 'LesCorts_2', 'PobleSec_3', 'LesCorts_4', 'ElBorn_2', 'ElBorn_3', 'LesCorts_0', 'PobleSec_0', 'PobleSec_1', 'ElBorn_1']
[31mStarting poisoning...!
INFO logger 2024-02-12 21:41:50,947 | train_utils.py:153 | Best Loss: 0.0003356432912555354
INFO logger 2024-02-12 21:41:52,102 | train_utils.py:153 | Best Loss: 0.00048219764949827213
INFO logger 2024-02-12 21:41:53,512 | train_utils.py:153 | Best Loss: 0.0004605070486166111
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-12 21:41:54,080 | train_utils.py:153 | Best Loss: 0.00021519607769838277
INFO logger 2024-02-12 21:41:54,342 | train_utils.py:153 | Best Loss: 2.704441241170887e-05
INFO logger 2024-02-12 21:41:55,047 | train_utils.py:153 | Best Loss: 0.0005554203733758272
INFO logger 2024-02-12 21:41:55,491 | train_utils.py:153 | Best Loss: 0.00021486838037769
INFO logger 2024-02-12 21:41:57,016 | train_utils.py:153 | Best Loss: 0.00046282758760288006
INFO logger 2024-02-12 21:41:58,196 | train_utils.py:153 | Best Loss: 0.00017418319152461158
INFO logger 2024-02-12 21:41:58,737 | train_utils.py:153 | Best Loss: 2.86163878345925e-05
INFO logger 2024-02-12 21:41:59,262 | train_utils.py:153 | Best Loss: 0.0001559492036394307
INFO logger 2024-02-12 21:41:59,706 | train_utils.py:153 | Best Loss: 0.000720918799440066
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:00,963 | train_utils.py:153 | Best Loss: 0.000442783231663657
INFO logger 2024-02-12 21:42:02,658 | train_utils.py:153 | Best Loss: 0.0004338021676136753
INFO logger 2024-02-12 21:42:03,218 | train_utils.py:153 | Best Loss: 2.6967046345957523e-05
INFO logger 2024-02-12 21:42:03,796 | server.py:244 | [Global round 1] Aggregating local models...
INFO logger 2024-02-12 21:42:03,798 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['ElBorn_4']
Preds shape is: (15, 535, 5)
Preds shape by feat is: (15, 535)
end_idx: 20
end_idx: 40
end_idx: 60
end_idx: 80
end_idx: 100
end_idx: 120
end_idx: 140
end_idx: 160
end_idx: 180
end_idx: 200
end_idx: 220
end_idx: 240
end_idx: 260
end_idx: 280
end_idx: 300
end_idx: 320
end_idx: 340
end_idx: 360
end_idx: 380
end_idx: 400
end_idx: 420
end_idx: 440
end_idx: 460
end_idx: 480
end_idx: 500
end_idx: 520
end_idx: 535
[[434.]
 [456.]
 [497.]
 [386.]
 [480.]
 [452.]
 [373.]
 [480.]
 [505.]
 [455.]
 [346.]
 [407.]
 [464.]
 [479.]
 [481.]]
INFO logger 2024-02-12 21:42:03,959 | server.py:324 | [Dataset PobleSec Evaluation on 3175 samples] loss: 0.0005100958987953156, mse: 0.06504955142736435, rmse: 0.2550481355104647, mae: 0.12497235834598541, nrmse: 1.4158807729998284
INFO logger 2024-02-12 21:42:04,055 | server.py:324 | [Dataset LesCorts Evaluation on 1368 samples] loss: 0.0004561787780254469, mse: 0.05796334892511368, rmse: 0.2407557868984953, mae: 0.19019953906536102, nrmse: 4.044311692380399
INFO logger 2024-02-12 21:42:04,137 | server.py:324 | [Dataset ElBorn Evaluation on 828 samples] loss: 5.799340160680566e-05, mse: 0.007064645178616047, rmse: 0.08405144364385449, mae: 0.06731375306844711, nrmse: 1.0043091975102763
INFO logger 2024-02-12 21:42:04,143 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['ElBorn_2', 'PobleSec_2', 'ElBorn_1', 'LesCorts_4', 'ElBorn_4', 'LesCorts_3', 'PobleSec_4', 'PobleSec_0', 'ElBorn_0', 'LesCorts_0', 'LesCorts_1', 'PobleSec_1', 'PobleSec_3', 'LesCorts_2', 'ElBorn_3']
INFO logger 2024-02-12 21:42:04,711 | train_utils.py:153 | Best Loss: 2.164518669279121e-05
INFO logger 2024-02-12 21:42:06,156 | train_utils.py:153 | Best Loss: 0.000416604576441716
INFO logger 2024-02-12 21:42:07,331 | train_utils.py:153 | Best Loss: 2.5943396016865394e-05
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:07,956 | train_utils.py:153 | Best Loss: 0.00010117289898862616
INFO logger 2024-02-12 21:42:08,395 | train_utils.py:153 | Best Loss: 2.2657226421307898e-05
INFO logger 2024-02-12 21:42:09,239 | train_utils.py:153 | Best Loss: 0.0003971603565593386
INFO logger 2024-02-12 21:42:10,580 | train_utils.py:153 | Best Loss: 0.0003935059749587314
INFO logger 2024-02-12 21:42:12,498 | train_utils.py:153 | Best Loss: 0.00039575079001310306
[31mStarting poisoning...!
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:13,678 | train_utils.py:153 | Best Loss: 0.0001612900990254925
INFO logger 2024-02-12 21:42:14,692 | train_utils.py:153 | Best Loss: 0.00046362379587620324
INFO logger 2024-02-12 21:42:15,189 | train_utils.py:153 | Best Loss: 0.00018676360170438624
INFO logger 2024-02-12 21:42:16,117 | train_utils.py:153 | Best Loss: 0.0003839542954338817
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:17,792 | train_utils.py:153 | Best Loss: 0.0003996967946318543
INFO logger 2024-02-12 21:42:18,236 | train_utils.py:153 | Best Loss: 9.829526132637123e-05
INFO logger 2024-02-12 21:42:18,667 | train_utils.py:153 | Best Loss: 0.00019441971753314497
INFO logger 2024-02-12 21:42:19,104 | server.py:244 | [Global round 2] Aggregating local models...
INFO logger 2024-02-12 21:42:19,113 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['LesCorts_1']
INFO logger 2024-02-12 21:42:19,351 | server.py:324 | [Dataset PobleSec Evaluation on 3175 samples] loss: 0.0004358079800690253, mse: 0.05557135492563248, rmse: 0.23573577353815536, mae: 0.10220281034708023, nrmse: 1.313544685038711
Preds shape is: (15, 535, 5)
Preds shape by feat is: (15, 535)
end_idx: 20
end_idx: 40
end_idx: 60
end_idx: 80
end_idx: 100
end_idx: 120
end_idx: 140
end_idx: 160
end_idx: 180
end_idx: 200
end_idx: 220
end_idx: 240
end_idx: 260
end_idx: 280
end_idx: 300
end_idx: 320
end_idx: 340
end_idx: 360
end_idx: 380
end_idx: 400
end_idx: 420
end_idx: 440
end_idx: 460
end_idx: 480
end_idx: 500
end_idx: 520
end_idx: 535
[[498.]
 [474.]
 [533.]
 [452.]
 [505.]
 [312.]
 [448.]
 [452.]
 [347.]
 [348.]
 [406.]
 [462.]
 [462.]
 [449.]
 [332.]]
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:19,718 | server.py:324 | [Dataset LesCorts Evaluation on 1368 samples] loss: 0.00028538048044064935, mse: 0.03625936433672905, rmse: 0.19041891801165411, mae: 0.14522583782672882, nrmse: 2.7999364673252725
INFO logger 2024-02-12 21:42:19,761 | server.py:324 | [Dataset ElBorn Evaluation on 828 samples] loss: 2.856463531891541e-05, mse: 0.003480152692645788, rmse: 0.0589928189921942, mae: 0.04356618598103523, nrmse: 0.7021140110371017
INFO logger 2024-02-12 21:42:19,765 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['LesCorts_0', 'LesCorts_4', 'PobleSec_0', 'ElBorn_3', 'LesCorts_3', 'LesCorts_2', 'PobleSec_3', 'ElBorn_4', 'ElBorn_0', 'PobleSec_2', 'LesCorts_1', 'PobleSec_4', 'ElBorn_2', 'ElBorn_1', 'PobleSec_1']
INFO logger 2024-02-12 21:42:20,436 | train_utils.py:153 | Best Loss: 0.0003076322983993947
INFO logger 2024-02-12 21:42:21,065 | train_utils.py:153 | Best Loss: 0.00010343992722503929
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:22,278 | train_utils.py:153 | Best Loss: 0.00037373818262795527
INFO logger 2024-02-12 21:42:23,060 | train_utils.py:153 | Best Loss: 0.00012212763158019613
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:23,842 | train_utils.py:153 | Best Loss: 0.00032887740839512375
INFO logger 2024-02-12 21:42:24,554 | train_utils.py:153 | Best Loss: 0.00010636979690208291
INFO logger 2024-02-12 21:42:25,809 | train_utils.py:153 | Best Loss: 0.0003796609070914702
INFO logger 2024-02-12 21:42:26,748 | train_utils.py:153 | Best Loss: 1.601133545340997e-05
INFO logger 2024-02-12 21:42:27,281 | train_utils.py:153 | Best Loss: 0.00014074119640253304
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:28,691 | train_utils.py:153 | Best Loss: 0.0003889647029398933
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:29,709 | train_utils.py:153 | Best Loss: 0.00018115565984112302
INFO logger 2024-02-12 21:42:30,652 | train_utils.py:153 | Best Loss: 0.00037419073949164646
INFO logger 2024-02-12 21:42:31,383 | train_utils.py:153 | Best Loss: 1.713739590525879e-05
INFO logger 2024-02-12 21:42:31,909 | train_utils.py:153 | Best Loss: 1.8485816722006902e-05
INFO logger 2024-02-12 21:42:33,205 | train_utils.py:153 | Best Loss: 0.0003652275330570387
Preds shape is: (15, 535, 5)
Preds shape by feat is: (15, 535)
end_idx: 20
end_idx: 40
end_idx: 60
end_idx: 80
end_idx: 100
end_idx: 120
end_idx: 140
end_idx: 160
end_idx: 180
end_idx: 200
end_idx: 220
end_idx: 240
end_idx: 260
end_idx: 280
end_idx: 300
end_idx: 320
end_idx: 340
end_idx: 360
end_idx: 380
end_idx: 400
end_idx: 420
end_idx: 440
end_idx: 460
end_idx: 480
end_idx: 500
end_idx: 520
end_idx: 535
[[414.]
 [499.]
 [460.]
 [364.]
 [349.]
 [508.]
 [461.]
 [460.]
 [352.]
 [435.]
 [370.]
 [453.]
 [465.]
 [506.]
 [457.]]
INFO logger 2024-02-12 21:42:34,014 | server.py:244 | [Global round 3] Aggregating local models...
INFO logger 2024-02-12 21:42:34,016 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['LesCorts_4']
INFO logger 2024-02-12 21:42:34,199 | server.py:324 | [Dataset PobleSec Evaluation on 3175 samples] loss: 0.0003981980303757069, mse: 0.05076528713107109, rmse: 0.22531153350654531, mae: 0.09528116881847382, nrmse: 1.2577982739127231
INFO logger 2024-02-12 21:42:34,262 | server.py:324 | [Dataset LesCorts Evaluation on 1368 samples] loss: 0.00022072877431266578, mse: 0.028036007657647133, rmse: 0.1674395641945091, mae: 0.1277032047510147, nrmse: 2.2863817187520263
INFO logger 2024-02-12 21:42:34,286 | server.py:324 | [Dataset ElBorn Evaluation on 828 samples] loss: 2.35766743519006e-05, mse: 0.002856411039829254, rmse: 0.05344540241993931, mae: 0.03848841041326523, nrmse: 0.6588187511058681
INFO logger 2024-02-12 21:42:34,290 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['LesCorts_2', 'PobleSec_3', 'LesCorts_0', 'ElBorn_3', 'PobleSec_2', 'ElBorn_1', 'PobleSec_1', 'LesCorts_3', 'LesCorts_4', 'LesCorts_1', 'ElBorn_4', 'PobleSec_4', 'ElBorn_0', 'ElBorn_2', 'PobleSec_0']
INFO logger 2024-02-12 21:42:34,663 | train_utils.py:153 | Best Loss: 0.00010081411173229503
INFO logger 2024-02-12 21:42:36,322 | train_utils.py:153 | Best Loss: 0.00036851919556813914
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:37,634 | train_utils.py:153 | Best Loss: 0.000243608498052634
INFO logger 2024-02-12 21:42:38,091 | train_utils.py:153 | Best Loss: 0.00011930305506260211
INFO logger 2024-02-12 21:42:38,960 | train_utils.py:153 | Best Loss: 0.0003739158148092665
INFO logger 2024-02-12 21:42:39,407 | train_utils.py:153 | Best Loss: 1.4433251459889367e-05
INFO logger 2024-02-12 21:42:40,643 | train_utils.py:153 | Best Loss: 0.0003554239249091566
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:41,489 | train_utils.py:153 | Best Loss: 0.0002833845377055525
INFO logger 2024-02-12 21:42:42,300 | train_utils.py:153 | Best Loss: 0.00010508627253611796
INFO logger 2024-02-12 21:42:42,821 | train_utils.py:153 | Best Loss: 0.000165077912817268
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:43,473 | train_utils.py:153 | Best Loss: 1.4853769753596201e-05
INFO logger 2024-02-12 21:42:44,944 | train_utils.py:153 | Best Loss: 0.0003608593052458458
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:45,679 | train_utils.py:153 | Best Loss: 0.00013849057329161731
INFO logger 2024-02-12 21:42:46,207 | train_utils.py:153 | Best Loss: 1.3099689273375136e-05
INFO logger 2024-02-12 21:42:47,362 | train_utils.py:153 | Best Loss: 0.0003659076113107167
Preds shape is: (15, 535, 5)
Preds shape by feat is: (15, 535)
end_idx: 20
end_idx: 40
end_idx: 60
end_idx: 80
end_idx: 100
end_idx: 120
end_idx: 140
end_idx: 160
end_idx: 180
end_idx: 200
end_idx: 220
end_idx: 240
end_idx: 260
end_idx: 280
end_idx: 300
end_idx: 320
end_idx: 340
end_idx: 360
end_idx: 380
end_idx: 400
end_idx: 420
end_idx: 440
end_idx: 460
end_idx: 480
end_idx: 500
end_idx: 520
end_idx: 535
[[531.]
 [458.]
 [388.]
 [373.]
 [448.]
 [494.]
 [460.]
 [359.]
 [451.]
 [444.]
 [441.]
 [469.]
 [315.]
 [508.]
 [481.]]
INFO logger 2024-02-12 21:42:47,999 | server.py:244 | [Global round 4] Aggregating local models...
INFO logger 2024-02-12 21:42:48,002 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['PobleSec_4']
INFO logger 2024-02-12 21:42:48,424 | server.py:324 | [Dataset PobleSec Evaluation on 3175 samples] loss: 0.00038053061387787656, mse: 0.04850593954324722, rmse: 0.2202406400809061, mae: 0.09337835013866425, nrmse: 1.23357779348784
INFO logger 2024-02-12 21:42:48,460 | server.py:324 | [Dataset LesCorts Evaluation on 1368 samples] loss: 0.00019639809459328042, mse: 0.024931591004133224, rmse: 0.15789740657823745, mae: 0.1177564412355423, nrmse: 1.8993568302514796
INFO logger 2024-02-12 21:42:48,484 | server.py:324 | [Dataset ElBorn Evaluation on 828 samples] loss: 2.3073595942893392e-05, mse: 0.0027880044654011726, rmse: 0.052801557414541976, mae: 0.03814812749624252, nrmse: 0.6212820264110899
INFO logger 2024-02-12 21:42:48,485 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['LesCorts_3', 'LesCorts_2', 'ElBorn_1', 'ElBorn_4', 'PobleSec_4', 'PobleSec_1', 'PobleSec_2', 'LesCorts_0', 'LesCorts_1', 'LesCorts_4', 'PobleSec_0', 'ElBorn_2', 'PobleSec_3', 'ElBorn_0', 'ElBorn_3']
INFO logger 2024-02-12 21:42:49,158 | train_utils.py:153 | Best Loss: 0.00025181242466321466
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:49,784 | train_utils.py:153 | Best Loss: 0.00010100474029000609
INFO logger 2024-02-12 21:42:50,243 | train_utils.py:153 | Best Loss: 1.3702981309528836e-05
INFO logger 2024-02-12 21:42:50,727 | train_utils.py:153 | Best Loss: 1.4498567415045907e-05
INFO logger 2024-02-12 21:42:51,723 | train_utils.py:153 | Best Loss: 0.000354326611135419
INFO logger 2024-02-12 21:42:53,368 | train_utils.py:153 | Best Loss: 0.00034917530825537605
INFO logger 2024-02-12 21:42:54,668 | train_utils.py:153 | Best Loss: 0.0003645723773071205
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-12 21:42:55,654 | train_utils.py:153 | Best Loss: 0.00021306744215694086
INFO logger 2024-02-12 21:42:56,622 | train_utils.py:153 | Best Loss: 0.00014520950114343598
INFO logger 2024-02-12 21:42:57,274 | train_utils.py:153 | Best Loss: 9.905825551512123e-05
INFO logger 2024-02-12 21:42:58,458 | train_utils.py:153 | Best Loss: 0.0003584645266505325
INFO logger 2024-02-12 21:42:59,172 | train_utils.py:153 | Best Loss: 1.3793909689973914e-05
INFO logger 2024-02-12 21:43:00,971 | train_utils.py:153 | Best Loss: 0.00036210825501787144
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-12 21:43:01,661 | train_utils.py:153 | Best Loss: 0.00013040004136121792
INFO logger 2024-02-12 21:43:02,075 | train_utils.py:153 | Best Loss: 0.0001326632159559623
INFO logger 2024-02-12 21:43:02,683 | server.py:244 | [Global round 5] Aggregating local models...
INFO logger 2024-02-12 21:43:02,685 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['LesCorts_0']
INFO logger 2024-02-12 21:43:02,928 | server.py:324 | [Dataset PobleSec Evaluation on 3175 samples] loss: 0.0003662197347583733, mse: 0.04667721316218376, rmse: 0.21604909896174934, mae: 0.08861736953258514, nrmse: 1.210967532321431
INFO logger 2024-02-12 21:43:02,963 | server.py:324 | [Dataset LesCorts Evaluation on 1368 samples] loss: 0.00019333102060917613, mse: 0.0245517548173666, rmse: 0.15668999590709867, mae: 0.11551187187433243, nrmse: 1.8695659945660774
INFO logger 2024-02-12 21:43:02,986 | server.py:324 | [Dataset ElBorn Evaluation on 828 samples] loss: 2.103167893095077e-05, mse: 0.00253814784809947, rmse: 0.05038003422090412, mae: 0.03505035489797592, nrmse: 0.5913325071556694
INFO logger 2024-02-12 21:43:02,991 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['LesCorts_4', 'ElBorn_3', 'ElBorn_4', 'ElBorn_2', 'PobleSec_3', 'PobleSec_1', 'ElBorn_0', 'PobleSec_2', 'PobleSec_0', 'LesCorts_3', 'LesCorts_0', 'ElBorn_1', 'LesCorts_2', 'PobleSec_4', 'LesCorts_1']
INFO logger 2024-02-12 21:43:03,334 | train_utils.py:153 | Best Loss: 9.611435064348823e-05
Preds shape is: (15, 535, 5)
Preds shape by feat is: (15, 535)
end_idx: 20
end_idx: 40
end_idx: 60
end_idx: 80
end_idx: 100
end_idx: 120
end_idx: 140
end_idx: 160
end_idx: 180
end_idx: 200
end_idx: 220
end_idx: 240
end_idx: 260
end_idx: 280
end_idx: 300
end_idx: 320
end_idx: 340
end_idx: 360
end_idx: 380
end_idx: 400
end_idx: 420
end_idx: 440
end_idx: 460
end_idx: 480
end_idx: 500
end_idx: 520
end_idx: 535
[[380.]
 [430.]
 [503.]
 [455.]
 [475.]
 [472.]
 [461.]
 [383.]
 [457.]
 [452.]
 [488.]
 [508.]
 [460.]
 [340.]
 [340.]]
[31mStarting poisoning...!
INFO logger 2024-02-12 21:43:03,888 | train_utils.py:153 | Best Loss: 0.00012271152134390846
INFO logger 2024-02-12 21:43:04,500 | train_utils.py:153 | Best Loss: 1.3651963208626578e-05
INFO logger 2024-02-12 21:43:04,873 | train_utils.py:153 | Best Loss: 1.4383825704068449e-05
INFO logger 2024-02-12 21:43:06,373 | train_utils.py:153 | Best Loss: 0.00035757600799144254
INFO logger 2024-02-12 21:43:07,450 | train_utils.py:153 | Best Loss: 0.0003448895775845025
[31mStarting poisoning...!
INFO logger 2024-02-12 21:43:08,092 | train_utils.py:153 | Best Loss: 0.0001348987219468263
INFO logger 2024-02-12 21:43:09,612 | train_utils.py:153 | Best Loss: 0.0003587340639801476
INFO logger 2024-02-12 21:43:10,951 | train_utils.py:153 | Best Loss: 0.00035457553336484815
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-12 21:43:11,836 | train_utils.py:153 | Best Loss: 0.00021680216686201025
INFO logger 2024-02-12 21:43:12,743 | train_utils.py:153 | Best Loss: 0.00017901085731056
INFO logger 2024-02-12 21:43:13,083 | train_utils.py:153 | Best Loss: 1.2857822452757309e-05
INFO logger 2024-02-12 21:43:13,632 | train_utils.py:153 | Best Loss: 0.00010020379981227567
INFO logger 2024-02-12 21:43:14,663 | train_utils.py:153 | Best Loss: 0.00035075718300475733
INFO logger 2024-02-12 21:43:15,472 | train_utils.py:153 | Best Loss: 0.00014565127618523717
[31mStarting poisoning...!
Preds shape is: (15, 535, 5)
Preds shape by feat is: (15, 535)
end_idx: 20
end_idx: 40
end_idx: 60
end_idx: 80
end_idx: 100
end_idx: 120
end_idx: 140
end_idx: 160
end_idx: 180
end_idx: 200
end_idx: 220
end_idx: 240
end_idx: 260
end_idx: 280
end_idx: 300
end_idx: 320
end_idx: 340
end_idx: 360
end_idx: 380
end_idx: 400
end_idx: 420
end_idx: 440
end_idx: 460
end_idx: 480
end_idx: 500
end_idx: 520
end_idx: 535
[[460.]
 [341.]
 [494.]
 [512.]
 [470.]
 [472.]
 [344.]
 [466.]
 [491.]
 [413.]
 [404.]
 [507.]
 [436.]
 [480.]
 [442.]]
INFO logger 2024-02-12 21:43:16,147 | server.py:244 | [Global round 6] Aggregating local models...
INFO logger 2024-02-12 21:43:16,155 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['PobleSec_4']
INFO logger 2024-02-12 21:43:16,479 | server.py:324 | [Dataset PobleSec Evaluation on 3175 samples] loss: 0.00035918687602255755, mse: 0.045776866376399994, rmse: 0.21395529060156468, mae: 0.08709260821342468, nrmse: 1.1977249895067226
INFO logger 2024-02-12 21:43:16,541 | server.py:324 | [Dataset LesCorts Evaluation on 1368 samples] loss: 0.00018744325307497417, mse: 0.023802153766155243, rmse: 0.15427946644370807, mae: 0.11364450305700302, nrmse: 2.0119707991056295
INFO logger 2024-02-12 21:43:16,571 | server.py:324 | [Dataset ElBorn Evaluation on 828 samples] loss: 2.0140474932133287e-05, mse: 0.0024305160623043776, rmse: 0.049300264322865224, mae: 0.03402598947286606, nrmse: 0.5345082716887106
INFO logger 2024-02-12 21:43:16,576 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['PobleSec_1', 'PobleSec_3', 'LesCorts_3', 'PobleSec_0', 'LesCorts_1', 'PobleSec_2', 'ElBorn_4', 'ElBorn_3', 'PobleSec_4', 'ElBorn_1', 'LesCorts_4', 'LesCorts_2', 'ElBorn_2', 'LesCorts_0', 'ElBorn_0']
INFO logger 2024-02-12 21:43:17,601 | train_utils.py:153 | Best Loss: 0.0003423953466814041
INFO logger 2024-02-12 21:43:18,831 | train_utils.py:153 | Best Loss: 0.0003548771301357765
[31mStarting poisoning...!
INFO logger 2024-02-12 21:43:19,936 | train_utils.py:153 | Best Loss: 0.0002118273412166109
INFO logger 2024-02-12 21:43:21,035 | train_utils.py:153 | Best Loss: 0.00035037195286163544
[31mStarting poisoning...!
INFO logger 2024-02-12 21:43:22,160 | train_utils.py:153 | Best Loss: 0.00013296841167196718
INFO logger 2024-02-12 21:43:23,372 | train_utils.py:153 | Best Loss: 0.0003551151146598923
[31mStarting poisoning...!
INFO logger 2024-02-12 21:43:24,147 | train_utils.py:153 | Best Loss: 1.1793119835122916e-05
INFO logger 2024-02-12 21:43:24,746 | train_utils.py:153 | Best Loss: 0.00011831034055870512
INFO logger 2024-02-12 21:43:26,272 | train_utils.py:153 | Best Loss: 0.0003480979269297104
INFO logger 2024-02-12 21:43:26,928 | train_utils.py:153 | Best Loss: 1.1554973208118267e-05
INFO logger 2024-02-12 21:43:27,583 | train_utils.py:153 | Best Loss: 9.537837740404216e-05
INFO logger 2024-02-12 21:43:28,285 | train_utils.py:153 | Best Loss: 9.89968896631086e-05
INFO logger 2024-02-12 21:43:28,764 | train_utils.py:153 | Best Loss: 1.309570000992845e-05
INFO logger 2024-02-12 21:43:29,373 | train_utils.py:153 | Best Loss: 0.0001782386969469967
[31mStarting poisoning...!
[31mStarting poisoning...!
Preds shape is: (15, 535, 5)
Preds shape by feat is: (15, 535)
end_idx: 20
end_idx: 40
end_idx: 60
end_idx: 80
end_idx: 100
end_idx: 120
end_idx: 140
end_idx: 160
end_idx: 180
end_idx: 200
end_idx: 220
end_idx: 240
end_idx: 260
end_idx: 280
end_idx: 300
end_idx: 320
end_idx: 340
end_idx: 360
end_idx: 380
end_idx: 400
end_idx: 420
end_idx: 440
end_idx: 460
end_idx: 480
end_idx: 500
end_idx: 520
end_idx: 535
INFO logger 2024-02-12 21:43:29,877 | train_utils.py:153 | Best Loss: 0.00015404833264756894
INFO logger 2024-02-12 21:43:30,362 | server.py:244 | [Global round 7] Aggregating local models...
INFO logger 2024-02-12 21:43:30,364 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['LesCorts_2']
INFO logger 2024-02-12 21:43:30,500 | server.py:324 | [Dataset PobleSec Evaluation on 3175 samples] loss: 0.00035644740166919907, mse: 0.04542453959584236, rmse: 0.2131303347621881, mae: 0.08773966878652573, nrmse: 1.1951415228662308
INFO logger 2024-02-12 21:43:30,584 | server.py:324 | [Dataset LesCorts Evaluation on 1368 samples] loss: 0.00016868747709515062, mse: 0.02140546217560768, rmse: 0.146306056524013, mae: 0.1064828485250473, nrmse: 1.6997559466141032
INFO logger 2024-02-12 21:43:30,606 | server.py:324 | [Dataset ElBorn Evaluation on 828 samples] loss: 2.010814296666551e-05, mse: 0.0024291235022246838, rmse: 0.04928613904765399, mae: 0.03489319607615471, nrmse: 0.5695362528512415
INFO logger 2024-02-12 21:43:30,611 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['PobleSec_0', 'PobleSec_4', 'PobleSec_1', 'LesCorts_0', 'ElBorn_1', 'PobleSec_2', 'PobleSec_3', 'LesCorts_2', 'ElBorn_4', 'LesCorts_4', 'ElBorn_2', 'LesCorts_3', 'ElBorn_0', 'LesCorts_1', 'ElBorn_3']
INFO logger 2024-02-12 21:43:31,511 | train_utils.py:153 | Best Loss: 0.0003469646683578768
[[473.]
 [469.]
 [391.]
 [490.]
 [454.]
 [474.]
 [486.]
 [360.]
 [479.]
 [507.]
 [453.]
 [531.]
 [524.]
 [413.]
 [337.]]
INFO logger 2024-02-12 21:43:32,767 | train_utils.py:153 | Best Loss: 0.0003463270890299143
INFO logger 2024-02-12 21:43:34,183 | train_utils.py:153 | Best Loss: 0.0003402966347442368
[31mStarting poisoning...!
INFO logger 2024-02-12 21:43:35,558 | train_utils.py:153 | Best Loss: 0.00017239573297270558
INFO logger 2024-02-12 21:43:36,091 | train_utils.py:153 | Best Loss: 1.2358589194026655e-05
INFO logger 2024-02-12 21:43:37,326 | train_utils.py:153 | Best Loss: 0.00035233119590662594
INFO logger 2024-02-12 21:43:38,901 | train_utils.py:153 | Best Loss: 0.00035096677616018595
INFO logger 2024-02-12 21:43:39,786 | train_utils.py:153 | Best Loss: 9.67024086854742e-05
INFO logger 2024-02-12 21:43:40,339 | train_utils.py:153 | Best Loss: 1.0949820249143465e-05
INFO logger 2024-02-12 21:43:40,878 | train_utils.py:153 | Best Loss: 9.556376574049045e-05
INFO logger 2024-02-12 21:43:41,249 | train_utils.py:153 | Best Loss: 1.0202703409792253e-05
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-12 21:43:42,132 | train_utils.py:153 | Best Loss: 0.00022597751329647518
INFO logger 2024-02-12 21:43:42,684 | train_utils.py:153 | Best Loss: 0.00011469090496896258
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-12 21:43:43,626 | train_utils.py:153 | Best Loss: 0.00013582274925007283
INFO logger 2024-02-12 21:43:43,986 | train_utils.py:153 | Best Loss: 0.00011211943560716323
INFO logger 2024-02-12 21:43:44,614 | server.py:244 | [Global round 8] Aggregating local models...
INFO logger 2024-02-12 21:43:44,623 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['ElBorn_1']
INFO logger 2024-02-12 21:43:44,736 | server.py:324 | [Dataset PobleSec Evaluation on 3175 samples] loss: 0.00035169039676919225, mse: 0.04481598734855652, rmse: 0.2116978680774951, mae: 0.08589881658554077, nrmse: 1.1899665142049585
INFO logger 2024-02-12 21:43:44,771 | server.py:324 | [Dataset LesCorts Evaluation on 1368 samples] loss: 0.00015830969586369325, mse: 0.02008197270333767, rmse: 0.14171087715252373, mae: 0.10319268703460693, nrmse: 1.585751606226215
INFO logger 2024-02-12 21:43:44,834 | server.py:324 | [Dataset ElBorn Evaluation on 828 samples] loss: 1.9834391915594826e-05, mse: 0.002392212161794305, rmse: 0.048910245979695344, mae: 0.03383220359683037, nrmse: 0.5565224888405439
INFO logger 2024-02-12 21:43:44,841 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['PobleSec_1', 'ElBorn_3', 'LesCorts_0', 'ElBorn_2', 'PobleSec_2', 'LesCorts_1', 'ElBorn_0', 'ElBorn_1', 'LesCorts_4', 'LesCorts_2', 'PobleSec_0', 'LesCorts_3', 'PobleSec_4', 'PobleSec_3', 'ElBorn_4']
Preds shape is: (15, 535, 5)
Preds shape by feat is: (15, 535)
end_idx: 20
end_idx: 40
end_idx: 60
end_idx: 80
end_idx: 100
end_idx: 120
end_idx: 140
end_idx: 160
end_idx: 180
end_idx: 200
end_idx: 220
end_idx: 240
end_idx: 260
end_idx: 280
end_idx: 300
end_idx: 320
end_idx: 340
end_idx: 360
end_idx: 380
end_idx: 400
end_idx: 420
end_idx: 440
end_idx: 460
end_idx: 480
end_idx: 500
end_idx: 520
end_idx: 535
[[495.]
 [492.]
 [477.]
 [428.]
 [494.]
 [481.]
 [469.]
 [527.]
 [445.]
 [517.]
 [511.]
 [338.]
 [367.]
 [441.]
 [377.]]
[31mStarting poisoning...!
INFO logger 2024-02-12 21:43:45,991 | train_utils.py:153 | Best Loss: 0.0003391323450358775
INFO logger 2024-02-12 21:43:46,678 | train_utils.py:153 | Best Loss: 0.00012231214030461324
INFO logger 2024-02-12 21:43:47,461 | train_utils.py:153 | Best Loss: 0.0001613448390312362
[31mStarting poisoning...!
INFO logger 2024-02-12 21:43:47,997 | train_utils.py:153 | Best Loss: 9.853433894110474e-06
INFO logger 2024-02-12 21:43:49,297 | train_utils.py:153 | Best Loss: 0.00035008766054080463
[31mStarting poisoning...!
Traceback (most recent call last):
  File "/home/judy/code/Fed-Time-Series-Forecasting/main.py", line 131, in <module>
    main(args)
  File "/home/judy/code/Fed-Time-Series-Forecasting/main.py", line 54, in main
    global_model, history = fit(
                            ^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/fl_trainer.py", line 137, in fit
    model_params, history = server.fit(args.fl_rounds, args.fraction, use_carbontracker=use_carbontracker,
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py", line 114, in fit
    self.fit_round(fl_round=fl_round,
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py", line 169, in fit_round
    res = self.fit_client(fl_round, client)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py", line 235, in fit_client
    fit_res = client.fit(model=self.global_model)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/client_proxy.py", line 37, in fit
    return self.client.fit(model)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/torch_client.py", line 117, in fit
    self.net: torch.nn.Module = train(model=self.net, train_loader=self.train_loader, test_loader=self.val_loader,
                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/utils/train_utils.py", line 105, in train
    test_loss, test_mse, test_rmse, test_mae, test_r2, test_nrmse = test(model, test_loader,
                                                                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/utils/train_utils.py", line 178, in test
    y_pred.extend(out)
  File "/home/judy/miniconda3/envs/judy/lib/python3.11/site-packages/torch/_tensor.py", line 1000, in __iter__
    return iter(self.unbind(0))
                ^^^^^^^^^^^^^^
KeyboardInterrupt