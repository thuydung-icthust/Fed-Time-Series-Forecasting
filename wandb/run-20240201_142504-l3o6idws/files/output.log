INFO logger 2024-02-01 14:25:10,956 | data_utils.py:383 | Observations info in ElBorn
INFO logger 2024-02-01 14:25:10,963 | data_utils.py:384 | 	Total number of samples:  4192
INFO logger 2024-02-01 14:25:10,963 | data_utils.py:385 | 	Number of samples for training: 3354
INFO logger 2024-02-01 14:25:10,963 | data_utils.py:386 | 	Number of samples for validation:  838
INFO logger 2024-02-01 14:25:10,966 | data_utils.py:383 | Observations info in LesCorts
INFO logger 2024-02-01 14:25:10,966 | data_utils.py:384 | 	Total number of samples:  6892
INFO logger 2024-02-01 14:25:10,967 | data_utils.py:385 | 	Number of samples for training: 5514
INFO logger 2024-02-01 14:25:10,967 | data_utils.py:386 | 	Number of samples for validation:  1378
INFO logger 2024-02-01 14:25:10,977 | data_utils.py:383 | Observations info in PobleSec
INFO logger 2024-02-01 14:25:10,977 | data_utils.py:384 | 	Total number of samples:  15927
INFO logger 2024-02-01 14:25:10,977 | data_utils.py:385 | 	Number of samples for training: 12742
INFO logger 2024-02-01 14:25:10,977 | data_utils.py:386 | 	Number of samples for validation:  3185
INFO logger 2024-02-01 14:25:10,979 | data_utils.py:389 | Observations info using all data
INFO logger 2024-02-01 14:25:10,979 | data_utils.py:390 | 	Total number of samples:  27011
INFO logger 2024-02-01 14:25:10,979 | data_utils.py:391 | 	Number of samples for training: 21610
INFO logger 2024-02-01 14:25:10,979 | data_utils.py:392 | 	Number of samples for validation:  5401
INFO logger 2024-02-01 14:25:10,979 | data_utils.py:118 | Using Flooring and Capping and with params: {'ElBorn': (10, 90), 'LesCorts': (10, 90), 'PobleSec': (5, 95)}
Clients participating training are: dict_keys(['ElBorn', 'LesCorts', 'PobleSec'])
INFO logger 2024-02-01 14:25:13,331 | server.py:69 | Initializing client manager...
INFO logger 2024-02-01 14:25:13,331 | server.py:76 | Registering clients...
INFO logger 2024-02-01 14:25:13,332 | client_manager.py:66 | Registered client with id: ElBorn_0
INFO logger 2024-02-01 14:25:13,332 | client_manager.py:66 | Registered client with id: ElBorn_1
INFO logger 2024-02-01 14:25:13,332 | client_manager.py:66 | Registered client with id: ElBorn_2
INFO logger 2024-02-01 14:25:13,332 | client_manager.py:66 | Registered client with id: ElBorn_3
INFO logger 2024-02-01 14:25:13,333 | client_manager.py:66 | Registered client with id: ElBorn_4
INFO logger 2024-02-01 14:25:13,333 | client_manager.py:66 | Registered client with id: LesCorts_0
INFO logger 2024-02-01 14:25:13,333 | client_manager.py:66 | Registered client with id: LesCorts_1
INFO logger 2024-02-01 14:25:13,333 | client_manager.py:66 | Registered client with id: LesCorts_2
INFO logger 2024-02-01 14:25:13,334 | client_manager.py:66 | Registered client with id: LesCorts_3
INFO logger 2024-02-01 14:25:13,334 | client_manager.py:66 | Registered client with id: LesCorts_4
INFO logger 2024-02-01 14:25:13,334 | client_manager.py:66 | Registered client with id: PobleSec_0
INFO logger 2024-02-01 14:25:13,334 | client_manager.py:66 | Registered client with id: PobleSec_1
INFO logger 2024-02-01 14:25:13,335 | client_manager.py:66 | Registered client with id: PobleSec_2
INFO logger 2024-02-01 14:25:13,335 | client_manager.py:66 | Registered client with id: PobleSec_3
INFO logger 2024-02-01 14:25:13,335 | client_manager.py:66 | Registered client with id: PobleSec_4
INFO logger 2024-02-01 14:25:13,335 | server.py:80 | Client manager initialized!
INFO logger 2024-02-01 14:25:13,336 | server.py:62 | Aggregation algorithm: FedAvg()
INFO logger 2024-02-01 14:25:13,336 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['PobleSec_3']
INFO logger 2024-02-01 14:25:15,301 | server.py:94 | Starting FL rounds
INFO logger 2024-02-01 14:25:15,302 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['LesCorts_1', 'PobleSec_2', 'PobleSec_4', 'ElBorn_0', 'ElBorn_4', 'LesCorts_3', 'LesCorts_2', 'PobleSec_3', 'LesCorts_4', 'ElBorn_2', 'ElBorn_3', 'LesCorts_0', 'PobleSec_0', 'PobleSec_1', 'ElBorn_1']
INFO logger 2024-02-01 14:25:16,566 | train_utils.py:153 | Best Loss: 0.0002896100798708915
INFO logger 2024-02-01 14:25:17,496 | train_utils.py:153 | Best Loss: 0.00048219764949827213
INFO logger 2024-02-01 14:25:18,540 | train_utils.py:153 | Best Loss: 0.0004605070486166111
INFO logger 2024-02-01 14:25:19,146 | train_utils.py:153 | Best Loss: 0.00016069088518115633
INFO logger 2024-02-01 14:25:19,508 | train_utils.py:153 | Best Loss: 2.704441241170887e-05
INFO logger 2024-02-01 14:25:19,837 | train_utils.py:153 | Best Loss: 0.0004772753332202372
INFO logger 2024-02-01 14:25:20,284 | train_utils.py:153 | Best Loss: 0.00021486838037769
INFO logger 2024-02-01 14:25:21,014 | train_utils.py:153 | Best Loss: 0.00046282758760288006
INFO logger 2024-02-01 14:25:21,623 | train_utils.py:153 | Best Loss: 0.00017418319152461158
INFO logger 2024-02-01 14:25:21,877 | train_utils.py:153 | Best Loss: 2.86163878345925e-05
INFO logger 2024-02-01 14:25:22,111 | train_utils.py:153 | Best Loss: 6.096589588222728e-05
INFO logger 2024-02-01 14:25:22,489 | train_utils.py:153 | Best Loss: 0.0005857830156425113
INFO logger 2024-02-01 14:25:23,340 | train_utils.py:153 | Best Loss: 0.000442783231663657
INFO logger 2024-02-01 14:25:24,791 | train_utils.py:153 | Best Loss: 0.0004338021676136753
INFO logger 2024-02-01 14:25:25,487 | train_utils.py:153 | Best Loss: 2.6967046345957523e-05
INFO logger 2024-02-01 14:25:25,583 | server.py:210 | [Global round 1] Aggregating local models...
INFO logger 2024-02-01 14:25:25,584 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['ElBorn_4']
Python 3.11.5 (main, Sep 11 2023, 13:54:46) [GCC 11.2.0]
Type 'copyright', 'credits' or 'license' for more information
IPython 8.17.2 -- An enhanced Interactive Python. Type '?' for help.
<ml.fl.client_proxy.SimpleClientProxy at 0x7febba226b10>
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Cell In[2], line 1
----> 1 net.net
AttributeError: 'SimpleClientProxy' object has no attribute 'net'
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Cell In[3], line 1
----> 1 net.model
AttributeError: 'SimpleClientProxy' object has no attribute 'model'
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Cell In[4], line 1
----> 1 net.net
AttributeError: 'SimpleClientProxy' object has no attribute 'net'
[array([[-5.0653552e-04,  5.8974884e-02, -7.2204769e-02, ...,
         -7.8253077e-05,  3.5455141e-02, -1.5114157e-02],
        [-1.6965909e-02, -7.1610548e-02, -5.7766411e-02, ...,
         -2.6753932e-02,  4.5022551e-02,  8.4742948e-02],
        [-1.7590266e-02,  7.0361458e-02, -1.3400304e-02, ...,
         -2.2243023e-02,  8.1004702e-02, -4.5217421e-02],
        ...,
        [ 1.6146967e-02, -5.3702174e-03,  2.8051820e-02, ...,
         -2.4891276e-02,  6.6087738e-02,  8.0668680e-02],
        [-2.4311985e-03, -4.5782875e-02, -5.5830102e-02, ...,
          6.5449081e-02, -7.2233945e-02,  1.4566947e-02],
        [-3.5761379e-02,  4.2071588e-02, -7.1834922e-03, ...,
          1.8897546e-02,  5.8718715e-02, -2.7465668e-02]], dtype=float32),
 array([[ 0.02708597, -0.04339211,  0.02394278, ...,  0.0073505 ,
         -0.00664423, -0.0561965 ],
        [-0.0356559 ,  0.02887606,  0.04638069, ..., -0.05263397,
          0.01899297,  0.04665371],
        [-0.03671628,  0.0473072 , -0.05849233, ...,  0.05451236,
          0.01263424,  0.06020762],
        ...,
        [ 0.00776528, -0.06150307, -0.00189166, ...,  0.0213849 ,
          0.04816146,  0.06830775],
        [-0.06711441,  0.03965602,  0.02422146, ..., -0.07246244,
         -0.03082458, -0.09293595],
        [ 0.04708903,  0.06066976,  0.03141319, ..., -0.0007429 ,
         -0.0298001 ,  0.00058262]], dtype=float32),
 array([-0.07209157,  0.07487586, -0.01383788, -0.04666802,  0.0055726 ,
         0.04358296,  0.0603781 ,  0.06341464, -0.01996206,  0.01925821,
         0.08476713,  0.04507766,  0.08465798,  0.02112154, -0.07480568,
         0.02591842, -0.02190286,  0.02071647,  0.02627023,  0.04697323,
        -0.04343714, -0.06342185,  0.07849473,  0.02321703,  0.03777871,
         0.01971317, -0.01930076, -0.0810556 ,  0.07258108,  0.07816793,
        -0.00955491, -0.02594039,  0.03836163, -0.07910504,  0.01824831,
         0.07457177, -0.02830961,  0.00181161,  0.04361804, -0.01037149,
        -0.00509453,  0.03225858, -0.00043735, -0.00161036, -0.0048223 ,
         0.04217119,  0.08502332,  0.00560376,  0.01483156, -0.06271955,
         0.05211484,  0.05261211, -0.06028638,  0.04306588,  0.02659315,
        -0.05083647, -0.01670177, -0.07218193,  0.00788717,  0.04324732,
        -0.05811529, -0.00479955,  0.06169238,  0.07009548,  0.05676719,
        -0.05320038, -0.00609946, -0.04347324,  0.07450097, -0.00165289,
        -0.05000655, -0.01111887,  0.00888236,  0.02778021, -0.02220981,
         0.00365273, -0.07644091, -0.0226239 ,  0.05044807,  0.03343044,
         0.08450089,  0.06502137,  0.05145559, -0.04099187,  0.0716821 ,
         0.06168157, -0.03572796, -0.03268167, -0.04357526, -0.05569985,
         0.03907989, -0.04211547,  0.08114189,  0.02712795, -0.00186003,
         0.03569886,  0.04768471, -0.01664998, -0.0698505 , -0.08672441,
         0.07949016,  0.08973052, -0.0315091 ,  0.08218567,  0.04232199,
        -0.0687261 , -0.00871962, -0.07318112,  0.03726703,  0.03550197,
         0.03907426, -0.00937478,  0.00959198, -0.05191582, -0.06795289,
        -0.02890072,  0.03434443, -0.01792681, -0.01865065, -0.04441223,
        -0.04101289, -0.04795159, -0.01476971,  0.08518135, -0.02366026,
        -0.00894414, -0.05071504, -0.04951995], dtype=float32),
 array([-0.08151335, -0.05360541, -0.02062297, -0.02163026, -0.06394816,
        -0.01412152,  0.0691838 , -0.06330357,  0.05148074, -0.06881802,
         0.01965379, -0.00154578, -0.07455997, -0.03945171, -0.03187768,
        -0.06759473,  0.00699022, -0.06541187,  0.07409681,  0.00212467,
        -0.0689036 , -0.03315879,  0.07473934, -0.00277297,  0.03599926,
         0.05635908, -0.04859316,  0.07618233, -0.05342722, -0.07927239,
         0.04585727, -0.06998924, -0.06053215, -0.06371003,  0.02469816,
        -0.00534025,  0.07083994, -0.03210381,  0.00398624,  0.04332963,
        -0.01771435, -0.00209382, -0.04981365,  0.05115312,  0.03367881,
        -0.02262358, -0.03397026,  0.05656402, -0.07567213,  0.03727909,
         0.06457419, -0.0269978 ,  0.03924356,  0.01491973,  0.0145473 ,
        -0.03456772, -0.01499666, -0.0066407 ,  0.02998108, -0.08871581,
        -0.00148398,  0.02972761,  0.01875529, -0.04570283, -0.03126662,
         0.04875116,  0.01653695,  0.08701029, -0.03626404,  0.04345364,
        -0.00763118,  0.01515501,  0.00200302, -0.08590051,  0.02708933,
         0.01301295, -0.07017434,  0.00107828,  0.01813909,  0.06827012,
         0.08540457, -0.02125665, -0.01002801, -0.01786412, -0.07313982,
         0.04428673,  0.08249041,  0.08423626, -0.0766995 , -0.08122814,
        -0.05382051, -0.01201776, -0.01985779, -0.07579838, -0.08042438,
        -0.06208169, -0.02753376, -0.00054354,  0.08342802, -0.08377852,
         0.05141253, -0.029044  ,  0.08908182, -0.06957786, -0.07089286,
        -0.00493189,  0.04146492, -0.06567662, -0.02175348, -0.06533683,
         0.047534  , -0.04784578, -0.0459618 , -0.07512389,  0.03202945,
         0.08348298,  0.02467557,  0.03297872,  0.06868896, -0.00213174,
         0.00267633,  0.07385963, -0.02619632, -0.07840589,  0.01031217,
         0.04037394,  0.02489938,  0.06993634], dtype=float32),
 array([[-0.11142878,  0.21092005,  0.09300647, -0.05244766, -0.13186188,
         -0.09709036, -0.04912625,  0.17412703, -0.09173248,  0.01777577,
          0.12896097, -0.00268692,  0.10321357, -0.10899906, -0.00098973,
          0.02792676,  0.13063486,  0.16950448, -0.13657473, -0.04835745,
         -0.13427809,  0.185045  ,  0.1757359 ,  0.16699757,  0.07264183,
         -0.05642918,  0.06363215, -0.16774239,  0.00624654, -0.11493264,
         -0.15433228, -0.20378952,  0.07446881,  0.14529392, -0.05623727,
         -0.19537382, -0.07166351,  0.07661641,  0.17904174,  0.11194929,
         -0.07302987,  0.19171481,  0.11385006,  0.01086956,  0.147537  ,
         -0.12687068,  0.01589855,  0.02293004, -0.00819151,  0.150693  ,
          0.12100746,  0.052661  ,  0.06258427, -0.13671616,  0.15830308,
         -0.00434782, -0.10471296,  0.04937731, -0.07890978,  0.03272408,
          0.00644823,  0.02303858,  0.1414898 ,  0.14148411,  0.17389472,
         -0.15488324, -0.02248322, -0.0470731 , -0.06905863, -0.19432756,
          0.13462234, -0.00848567,  0.16831005,  0.20004827,  0.08181351,
         -0.05801203,  0.18362176,  0.11076797,  0.12998207, -0.03026934,
          0.04943046, -0.16244023,  0.16204357,  0.17463128, -0.02323931,
         -0.02170043, -0.01439151,  0.05961789,  0.00953363, -0.1856328 ,
         -0.03451281, -0.0840515 ,  0.13435255, -0.14425208, -0.16891587,
          0.1625764 , -0.1677884 ,  0.10139761, -0.03471743, -0.20563644,
         -0.19234428,  0.00061007, -0.03517716,  0.07450089,  0.03137892,
         -0.10916421,  0.1712265 , -0.02185354,  0.05408454, -0.09169552,
         -0.04380865, -0.10940518, -0.11979669, -0.14477438,  0.10094228,
          0.1112001 ,  0.0913429 , -0.21261773,  0.01613068, -0.21021515,
         -0.08346928,  0.01083561,  0.12090674, -0.07192471,  0.12032375,
          0.08039276,  0.0115368 ,  0.19825405],
        [-0.05410899,  0.04817   , -0.07810528, -0.00878828,  0.0627244 ,
         -0.22551462,  0.15346128,  0.1052669 , -0.07325228, -0.12948312,
         -0.08920352,  0.07888987, -0.20365615, -0.0992179 , -0.151457  ,
          0.1735034 ,  0.11380628, -0.20641316, -0.17123286, -0.10623393,
          0.17237519,  0.17241034,  0.11992919,  0.06135034, -0.15812466,
         -0.02795328,  0.19946381, -0.12372859, -0.06353386,  0.131404  ,
         -0.0600355 , -0.11507034, -0.14633949, -0.12282694, -0.19051701,
         -0.03115825,  0.006943  ,  0.12774228, -0.1041799 , -0.05361496,
         -0.15769623,  0.19566177,  0.01382832, -0.21104704,  0.10388082,
          0.11942197,  0.14466308,  0.21485819, -0.04462878,  0.04660123,
          0.1539341 ,  0.04219392, -0.03837086,  0.02821675, -0.06125045,
          0.16556807,  0.09169509,  0.12695947,  0.07186109,  0.07455371,
          0.0094861 , -0.10373398, -0.00069353,  0.085967  , -0.12562099,
          0.21586138,  0.15527774, -0.12834351, -0.14730631,  0.04130516,
         -0.16090369,  0.08734711,  0.15070958,  0.0971919 ,  0.02623483,
         -0.11971501, -0.17941274,  0.0653073 ,  0.15310398, -0.01373755,
         -0.00491331, -0.0730757 ,  0.02547165, -0.08638263, -0.17278478,
          0.03287828, -0.06609834, -0.11234297, -0.1699055 , -0.06285135,
          0.02894972, -0.16041303,  0.03290604, -0.07487827,  0.08476883,
          0.0897155 , -0.05080559, -0.21180056, -0.05763485, -0.17750674,
          0.02282617, -0.207174  , -0.1616394 ,  0.11773457, -0.10522864,
          0.05040656,  0.17952758, -0.16146402, -0.19598919, -0.15290506,
          0.09045102,  0.19366986,  0.0333571 , -0.17530397, -0.12272118,
         -0.07870255, -0.20804185,  0.08451181,  0.14208354,  0.18861607,
         -0.208093  ,  0.07652455, -0.03315366, -0.21474084,  0.12423588,
          0.11833907, -0.01865594,  0.01308569],
        [-0.13406909,  0.12083726, -0.05267867, -0.01249254,  0.16367197,
         -0.13137618,  0.20166872,  0.11730418, -0.11912051, -0.13293833,
         -0.17356424,  0.12725522,  0.00911314, -0.02956481,  0.15937397,
         -0.05617754,  0.072856  ,  0.04060335, -0.01270576, -0.11269119,
         -0.13516712, -0.17954953,  0.1731235 ,  0.19177814,  0.2128376 ,
          0.10679712, -0.04285287, -0.12547655, -0.21584946, -0.08948009,
         -0.15498772, -0.05314501, -0.15028629, -0.14879042, -0.00791635,
         -0.15307735,  0.0227736 , -0.00733252,  0.18326221,  0.12289906,
          0.07602391, -0.14232965,  0.05387806, -0.12357431,  0.12771806,
          0.19406861, -0.1548754 ,  0.18648311, -0.12842329, -0.09632467,
         -0.126635  ,  0.0691046 , -0.19594528, -0.13831015,  0.0432929 ,
         -0.09790353,  0.1734395 , -0.02199227,  0.08231621,  0.08284312,
         -0.14059006,  0.17838264,  0.13837732,  0.07169229, -0.19699632,
          0.20627286, -0.14817874,  0.17749476,  0.19929351, -0.01546467,
          0.08341099, -0.15787189,  0.1552061 ,  0.02009765,  0.04924802,
         -0.04043766,  0.15160297, -0.16010366,  0.02854061,  0.07823125,
          0.12980072, -0.10242739,  0.03605516,  0.06031861, -0.10907426,
         -0.08718424,  0.03436254, -0.09448849,  0.2231557 ,  0.05477293,
         -0.05982041,  0.05641451, -0.09779746, -0.02101965,  0.05559362,
          0.08450828,  0.02651081, -0.00891655, -0.09422733, -0.18929444,
          0.16076031, -0.05148828, -0.18788967,  0.15371318,  0.17135593,
         -0.05186179,  0.00840548, -0.13867795,  0.12402838, -0.16368978,
          0.14859046,  0.06826783,  0.17204328, -0.12445474, -0.02064593,
          0.00957979,  0.07323994,  0.05460326,  0.03508289,  0.22674942,
          0.04138896, -0.12402717, -0.09609317,  0.10712619,  0.19043161,
         -0.19223067, -0.18242632, -0.15942267],
        [ 0.15679204, -0.12344837,  0.12483097, -0.09687955,  0.13621815,
         -0.01524001, -0.05919107,  0.14218596,  0.21002622, -0.08888488,
          0.16156694, -0.18281713, -0.15379499, -0.00061309,  0.17190449,
         -0.00144253,  0.16012003,  0.12598105,  0.14224343,  0.07214472,
         -0.20431864, -0.1528564 , -0.17325096,  0.0524698 ,  0.0389704 ,
          0.03807377, -0.19033279,  0.06438164, -0.12059239, -0.20429394,
          0.05541824, -0.00037026, -0.171481  ,  0.00084352,  0.10123006,
         -0.20435749,  0.00747453,  0.15871607,  0.17536846, -0.08281289,
         -0.077506  , -0.12410675, -0.15972184, -0.11078639,  0.14772661,
          0.15719797, -0.07975166,  0.03267132, -0.13206394, -0.0297173 ,
          0.13380007,  0.13828562, -0.0466723 , -0.1641876 ,  0.00059675,
         -0.10370558,  0.05582606,  0.18585719,  0.0091131 , -0.02821488,
         -0.04787721, -0.0130025 ,  0.05872468,  0.00403123, -0.18504551,
          0.2014485 , -0.12504786,  0.21060966, -0.00828324, -0.01272809,
          0.09551038, -0.09772043,  0.00554764, -0.07237425, -0.13511358,
          0.13292965,  0.1565836 ,  0.0879143 ,  0.21034841,  0.10917798,
          0.18681821, -0.03612886,  0.15718018,  0.04578149,  0.00090567,
          0.164628  , -0.16248524, -0.01644466, -0.09067441,  0.20644198,
         -0.028374  ,  0.07349712,  0.1508488 ,  0.10149112, -0.08852834,
         -0.00049305,  0.13299108, -0.09348609,  0.00912401, -0.16512854,
          0.05289013,  0.13655944,  0.01294735,  0.02343253,  0.17492038,
          0.00071977, -0.08748408,  0.15929034, -0.14872901,  0.09867135,
          0.13796084,  0.00785493, -0.21513475,  0.08586039,  0.1260935 ,
         -0.02289888,  0.14412332,  0.08064198,  0.03276954,  0.1966548 ,
         -0.11351424,  0.03759897, -0.15099932,  0.18272376,  0.0623701 ,
          0.1945775 , -0.1672754 ,  0.17613536],
        [ 0.13790627,  0.17934957, -0.0795257 , -0.18647817, -0.04846507,
          0.15862504,  0.20784298, -0.00824564,  0.03462821, -0.01021398,
         -0.01036128,  0.03180071,  0.10106638, -0.04764757, -0.16551937,
         -0.02139742,  0.11166219, -0.16727024,  0.20331052,  0.07579917,
          0.1086885 ,  0.11870828,  0.1520514 ,  0.1875406 , -0.08912459,
          0.05969518,  0.1374046 , -0.2098547 ,  0.11445176, -0.21442468,
         -0.14913478, -0.12193569, -0.1485328 , -0.14804968,  0.1239744 ,
         -0.19221619, -0.10298167, -0.19801861, -0.07544044,  0.00375652,
          0.0556685 , -0.11393059,  0.04912343,  0.09842522,  0.17435609,
         -0.04278671, -0.1340736 ,  0.13399428, -0.07397939, -0.21038973,
         -0.08941021, -0.03279245,  0.03524316,  0.15176612,  0.14326133,
         -0.08238164,  0.17830364,  0.07717457,  0.05274864, -0.1593051 ,
         -0.0407555 ,  0.07851416, -0.06194098,  0.08716951,  0.09452987,
         -0.14651546,  0.16207619,  0.02229578, -0.01157273, -0.02914985,
         -0.0218889 , -0.02269096, -0.05694653,  0.03472578, -0.05197737,
          0.15861486, -0.06414926, -0.18617742,  0.20333898,  0.11412924,
         -0.14917803,  0.17915976, -0.16841081, -0.10754884, -0.1154004 ,
          0.05200883,  0.06763986, -0.07914768, -0.05817318, -0.10946368,
          0.17447194,  0.11357604,  0.01051701,  0.00589934,  0.01200872,
         -0.04465443, -0.10697842,  0.1805465 , -0.08828095, -0.12990482,
         -0.02055102,  0.06379279, -0.16706556,  0.05755382, -0.00633887,
         -0.09853854,  0.03317494,  0.02876768, -0.21622775,  0.11348953,
          0.06987533, -0.12743555,  0.05694361, -0.12757574,  0.15334657,
         -0.08312689,  0.06929002,  0.06805458, -0.02756385, -0.09908125,
          0.08817742,  0.05184001, -0.09327876, -0.0457867 ,  0.08260839,
         -0.1780078 ,  0.01807833,  0.05511845]], dtype=float32),
 array([ 4.8752655e-03, -5.0960767e-05, -1.3773005e-03,  3.6820592e-03,
        -3.0501655e-03], dtype=float32)]
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
Cell In[6], line 1
----> 1 self.global_model.state_dict()
AttributeError: 'list' object has no attribute 'state_dict'
---------------------------------------------------------------------------
AttributeError                            Traceback (most recent call last)
File ~/code/Fed-Time-Series-Forecasting/main.py:122
    119     args.outlier_columns = outlier_columns
    120     args.outlier_kwargs = outlier_kwargs
--> 122 main(args)
File ~/code/Fed-Time-Series-Forecasting/main.py:46, in main(args)
     41 # federated local params
     42 local_train_params = {"epochs": args.epochs, "optimizer": args.optimizer, "lr": args.lr,
     43                     "criterion": args.criterion, "early_stopping": args.local_early_stopping,
     44                     "patience": args.local_patience, "device": args.device
     45                     }
---> 46 global_model, history = fit(
     47                             model,
     48                             client_X_train,
     49                             client_y_train,
     50                             client_X_val,
     51                             client_y_val,
     52                             local_train_params=local_train_params,
     53                             args = args,
     54                             wandb_ins=wandb_instance)
     56 validation_dict = inference(
     57                 global_model,
     58                 client_X_train,
   (...)
     64                 y_scalers,
     65                 args)
File ~/code/Fed-Time-Series-Forecasting/fl_trainer.py:133, in fit(model, X_train, y_train, X_val, y_val, exogenous_data_train, exogenous_data_val, idxs, log_per, client_creation_fn, local_train_params, aggregation_params, use_carbontracker, args, wandb_ins)
    122 # represent the server
    123 server = Server(
    124     client_proxies=client_proxies, # the client representations
    125     aggregation=args.aggregation, # the aggregation algorithm
   (...)
    129     model=copy.deepcopy(model)
    130 )
    131 # Note that the client manager instance will be initialized automatically. You can define your own client manager.
    132
--> 133 # train with FL
    134 model_params, history = server.fit(args.fl_rounds, args.fraction, use_carbontracker=use_carbontracker,
    135                                    wandb_ins=wandb_ins)
    137 params_dict = zip(model.state_dict().keys(), model_params)
File ~/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py:119, in fit(self, num_rounds, fraction, fraction_args, use_carbontracker, wandb_ins)
    115 if use_carbontracker and cb_tracker is not None:
    116     cb_tracker.epoch_end()
    117 # evaluate global model
    118 # test_metrics = self.evaluate_round(fl_round=fl_round,
--> 119 #                     history=history)
    120 random_net = copy.deepcopy(self.client_manager.sample(0.)[0])
    121 test_metrics = self.random_evaluate(self.global_val_loaders, self.global_model, net=random_net)
File ~/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py:282, in random_evaluate(self, val_loader, model, params, method, verbose, net)
    278     params["criterion"] = torch.nn.MSELoss()
    280 # if model:
    281 #     self.set_parameters(model)
--> 282 import IPython
    283 IPython.embed()
    284 net = net.net
AttributeError: 'SimpleClientProxy' object has no attribute 'net'