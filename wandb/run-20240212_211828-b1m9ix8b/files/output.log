INFO logger 2024-02-12 21:18:35,640 | data_utils.py:383 | Observations info in ElBorn
INFO logger 2024-02-12 21:18:35,640 | data_utils.py:384 | 	Total number of samples:  4192
INFO logger 2024-02-12 21:18:35,640 | data_utils.py:385 | 	Number of samples for training: 3354
INFO logger 2024-02-12 21:18:35,640 | data_utils.py:386 | 	Number of samples for validation:  838
INFO logger 2024-02-12 21:18:35,643 | data_utils.py:383 | Observations info in LesCorts
INFO logger 2024-02-12 21:18:35,643 | data_utils.py:384 | 	Total number of samples:  6892
INFO logger 2024-02-12 21:18:35,643 | data_utils.py:385 | 	Number of samples for training: 5514
INFO logger 2024-02-12 21:18:35,643 | data_utils.py:386 | 	Number of samples for validation:  1378
INFO logger 2024-02-12 21:18:35,660 | data_utils.py:383 | Observations info in PobleSec
INFO logger 2024-02-12 21:18:35,660 | data_utils.py:384 | 	Total number of samples:  15927
INFO logger 2024-02-12 21:18:35,660 | data_utils.py:385 | 	Number of samples for training: 12742
INFO logger 2024-02-12 21:18:35,660 | data_utils.py:386 | 	Number of samples for validation:  3185
INFO logger 2024-02-12 21:18:35,661 | data_utils.py:389 | Observations info using all data
INFO logger 2024-02-12 21:18:35,662 | data_utils.py:390 | 	Total number of samples:  27011
INFO logger 2024-02-12 21:18:35,662 | data_utils.py:391 | 	Number of samples for training: 21610
INFO logger 2024-02-12 21:18:35,662 | data_utils.py:392 | 	Number of samples for validation:  5401
INFO logger 2024-02-12 21:18:35,662 | data_utils.py:118 | Using Flooring and Capping and with params: {'ElBorn': (10, 90), 'LesCorts': (10, 90), 'PobleSec': (5, 95)}
X_val_sub.shape is 535 	 y_val_sub is 535
Clients participating training are: dict_keys(['ElBorn', 'LesCorts', 'PobleSec'])
INFO logger 2024-02-12 21:18:39,005 | server.py:74 | Initializing client manager...
INFO logger 2024-02-12 21:18:39,007 | server.py:81 | Registering clients...
INFO logger 2024-02-12 21:18:39,008 | client_manager.py:66 | Registered client with id: ElBorn_0
INFO logger 2024-02-12 21:18:39,008 | client_manager.py:66 | Registered client with id: ElBorn_1
INFO logger 2024-02-12 21:18:39,009 | client_manager.py:66 | Registered client with id: ElBorn_2
INFO logger 2024-02-12 21:18:39,009 | client_manager.py:66 | Registered client with id: ElBorn_3
INFO logger 2024-02-12 21:18:39,009 | client_manager.py:66 | Registered client with id: ElBorn_4
INFO logger 2024-02-12 21:18:39,010 | client_manager.py:66 | Registered client with id: LesCorts_0
INFO logger 2024-02-12 21:18:39,010 | client_manager.py:66 | Registered client with id: LesCorts_1
INFO logger 2024-02-12 21:18:39,011 | client_manager.py:66 | Registered client with id: LesCorts_2
INFO logger 2024-02-12 21:18:39,012 | client_manager.py:66 | Registered client with id: LesCorts_3
INFO logger 2024-02-12 21:18:39,012 | client_manager.py:66 | Registered client with id: LesCorts_4
INFO logger 2024-02-12 21:18:39,013 | client_manager.py:66 | Registered client with id: PobleSec_0
INFO logger 2024-02-12 21:18:39,013 | client_manager.py:66 | Registered client with id: PobleSec_1
INFO logger 2024-02-12 21:18:39,013 | client_manager.py:66 | Registered client with id: PobleSec_2
INFO logger 2024-02-12 21:18:39,014 | client_manager.py:66 | Registered client with id: PobleSec_3
INFO logger 2024-02-12 21:18:39,014 | client_manager.py:66 | Registered client with id: PobleSec_4
INFO logger 2024-02-12 21:18:39,015 | server.py:85 | Client manager initialized!
INFO logger 2024-02-12 21:18:39,015 | server.py:67 | Aggregation algorithm: FedAvg()
INFO logger 2024-02-12 21:18:39,016 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['PobleSec_3']
[31mStarting poisoning...!
INFO logger 2024-02-12 21:18:41,427 | server.py:99 | Starting FL rounds
INFO logger 2024-02-12 21:18:41,428 | client_manager.py:88 | Parameter c=1.0. Sampled 15 client(s): ['LesCorts_1', 'PobleSec_2', 'PobleSec_4', 'ElBorn_0', 'ElBorn_4', 'LesCorts_3', 'LesCorts_2', 'PobleSec_3', 'LesCorts_4', 'ElBorn_2', 'ElBorn_3', 'LesCorts_0', 'PobleSec_0', 'PobleSec_1', 'ElBorn_1']
INFO logger 2024-02-12 21:18:43,410 | train_utils.py:153 | Best Loss: 0.0003356432912555354
INFO logger 2024-02-12 21:18:44,908 | train_utils.py:153 | Best Loss: 0.00048219764949827213
INFO logger 2024-02-12 21:18:46,728 | train_utils.py:153 | Best Loss: 0.0004605070486166111
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-12 21:18:47,497 | train_utils.py:153 | Best Loss: 0.00021519607769838277
INFO logger 2024-02-12 21:18:47,902 | train_utils.py:153 | Best Loss: 2.704441241170887e-05
INFO logger 2024-02-12 21:18:48,515 | train_utils.py:153 | Best Loss: 0.0005554203733758272
INFO logger 2024-02-12 21:18:49,222 | train_utils.py:153 | Best Loss: 0.00021486838037769
INFO logger 2024-02-12 21:18:50,170 | train_utils.py:153 | Best Loss: 0.00046282758760288006
INFO logger 2024-02-12 21:18:51,071 | train_utils.py:153 | Best Loss: 0.00017418319152461158
[31mStarting poisoning...!
[31mStarting poisoning...!
INFO logger 2024-02-12 21:18:51,486 | train_utils.py:153 | Best Loss: 2.86163878345925e-05
INFO logger 2024-02-12 21:18:51,845 | train_utils.py:153 | Best Loss: 0.0001559492036394307
INFO logger 2024-02-12 21:18:52,426 | train_utils.py:153 | Best Loss: 0.000720918799440066
INFO logger 2024-02-12 21:18:53,719 | train_utils.py:153 | Best Loss: 0.000442783231663657
Preds shape is: (15, 535, 5)
Preds shape by feat is: (15, 535)
INFO logger 2024-02-12 21:18:55,517 | train_utils.py:153 | Best Loss: 0.0004338021676136753
INFO logger 2024-02-12 21:18:56,132 | train_utils.py:153 | Best Loss: 2.6967046345957523e-05
Traceback (most recent call last):
  File "/home/judy/code/Fed-Time-Series-Forecasting/main.py", line 131, in <module>
    main(args)
  File "/home/judy/code/Fed-Time-Series-Forecasting/main.py", line 54, in main
    global_model, history = fit(
                            ^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/fl_trainer.py", line 137, in fit
    model_params, history = server.fit(args.fl_rounds, args.fraction, use_carbontracker=use_carbontracker,
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py", line 114, in fit
    self.fit_round(fl_round=fl_round,
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py", line 186, in fit_round
    verifier_w = self.conduct_defense(model_vec_list)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py", line 223, in conduct_defense
    verifier_w = sat_verifier(preds, y_true, 0)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/verifier.py", line 155, in sat_verifier
    r_a = verify_by_allowable(preds, y_true[:, :, atk_feature])
                                     ~~~~~~^^^^^^^^^^^^^^^^^^^
IndexError: too many indices for array: array is 2-dimensional, but 3 were indexed