INFO logger 2024-02-01 10:41:00,665 | data_utils.py:383 | Observations info in ElBorn
INFO logger 2024-02-01 10:41:00,666 | data_utils.py:384 | 	Total number of samples:  4192
INFO logger 2024-02-01 10:41:00,666 | data_utils.py:385 | 	Number of samples for training: 3354
INFO logger 2024-02-01 10:41:00,666 | data_utils.py:386 | 	Number of samples for validation:  838
INFO logger 2024-02-01 10:41:00,669 | data_utils.py:383 | Observations info in LesCorts
INFO logger 2024-02-01 10:41:00,669 | data_utils.py:384 | 	Total number of samples:  6892
INFO logger 2024-02-01 10:41:00,669 | data_utils.py:385 | 	Number of samples for training: 5514
INFO logger 2024-02-01 10:41:00,670 | data_utils.py:386 | 	Number of samples for validation:  1378
INFO logger 2024-02-01 10:41:00,673 | data_utils.py:383 | Observations info in PobleSec
INFO logger 2024-02-01 10:41:00,673 | data_utils.py:384 | 	Total number of samples:  15927
INFO logger 2024-02-01 10:41:00,673 | data_utils.py:385 | 	Number of samples for training: 12742
INFO logger 2024-02-01 10:41:00,674 | data_utils.py:386 | 	Number of samples for validation:  3185
INFO logger 2024-02-01 10:41:00,675 | data_utils.py:389 | Observations info using all data
INFO logger 2024-02-01 10:41:00,675 | data_utils.py:390 | 	Total number of samples:  27011
INFO logger 2024-02-01 10:41:00,676 | data_utils.py:391 | 	Number of samples for training: 21610
INFO logger 2024-02-01 10:41:00,676 | data_utils.py:392 | 	Number of samples for validation:  5401
INFO logger 2024-02-01 10:41:00,676 | data_utils.py:118 | Using Flooring and Capping and with params: {'ElBorn': (10, 90), 'LesCorts': (10, 90), 'PobleSec': (5, 95)}
INFO logger 2024-02-01 10:41:01,699 | server.py:62 | Initializing client manager...
INFO logger 2024-02-01 10:41:01,713 | server.py:69 | Registering clients...
INFO logger 2024-02-01 10:41:01,714 | client_manager.py:66 | Registered client with id: ElBorn
INFO logger 2024-02-01 10:41:01,714 | client_manager.py:66 | Registered client with id: LesCorts
INFO logger 2024-02-01 10:41:01,714 | client_manager.py:66 | Registered client with id: PobleSec
INFO logger 2024-02-01 10:41:01,714 | server.py:73 | Client manager initialized!
INFO logger 2024-02-01 10:41:01,714 | server.py:55 | Aggregation algorithm: FedAvg()
INFO logger 2024-02-01 10:41:01,714 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['LesCorts']
Clients participating training are: dict_keys(['ElBorn', 'LesCorts', 'PobleSec'])
INFO logger 2024-02-01 10:41:02,760 | server.py:87 | Starting FL rounds
INFO logger 2024-02-01 10:41:02,761 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['LesCorts', 'ElBorn', 'PobleSec']
INFO logger 2024-02-01 10:41:04,588 | train_utils.py:153 | Best Loss: 9.611116624192188e-05
INFO logger 2024-02-01 10:41:05,413 | train_utils.py:153 | Best Loss: 1.827523342596934e-05
INFO logger 2024-02-01 10:41:07,879 | train_utils.py:153 | Best Loss: 0.00035936859661830575
INFO logger 2024-02-01 10:41:08,505 | server.py:201 | [Global round 1] Aggregating local models...
INFO logger 2024-02-01 10:41:09,714 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['PobleSec', 'LesCorts', 'ElBorn']
INFO logger 2024-02-01 10:41:12,587 | train_utils.py:153 | Best Loss: 0.00034176042789270676
INFO logger 2024-02-01 10:41:14,026 | train_utils.py:153 | Best Loss: 0.0001017630603355056
INFO logger 2024-02-01 10:41:14,789 | train_utils.py:153 | Best Loss: 1.0444965698038664e-05
INFO logger 2024-02-01 10:41:14,889 | server.py:201 | [Global round 2] Aggregating local models...
INFO logger 2024-02-01 10:41:15,610 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['LesCorts', 'PobleSec', 'ElBorn']
INFO logger 2024-02-01 10:41:16,532 | train_utils.py:153 | Best Loss: 0.00010052675276460964
INFO logger 2024-02-01 10:41:19,090 | train_utils.py:153 | Best Loss: 0.0003410475158616607
INFO logger 2024-02-01 10:41:20,797 | train_utils.py:153 | Best Loss: 8.229621737219106e-06
INFO logger 2024-02-01 10:41:20,913 | server.py:201 | [Global round 3] Aggregating local models...
INFO logger 2024-02-01 10:41:21,631 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['PobleSec', 'ElBorn', 'LesCorts']
INFO logger 2024-02-01 10:41:24,266 | train_utils.py:153 | Best Loss: 0.00034092506421289927
INFO logger 2024-02-01 10:41:25,745 | train_utils.py:153 | Best Loss: 6.619046831948926e-06
INFO logger 2024-02-01 10:41:26,736 | train_utils.py:153 | Best Loss: 9.171801655994434e-05
INFO logger 2024-02-01 10:41:26,900 | server.py:201 | [Global round 4] Aggregating local models...
INFO logger 2024-02-01 10:41:27,639 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['LesCorts', 'ElBorn', 'PobleSec']
INFO logger 2024-02-01 10:41:28,718 | train_utils.py:153 | Best Loss: 8.863085497590054e-05
INFO logger 2024-02-01 10:41:29,454 | train_utils.py:153 | Best Loss: 8.617796958199194e-06
INFO logger 2024-02-01 10:41:31,894 | train_utils.py:153 | Best Loss: 0.0003424245112311594
INFO logger 2024-02-01 10:41:32,392 | server.py:201 | [Global round 5] Aggregating local models...
INFO logger 2024-02-01 10:41:33,077 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['PobleSec', 'LesCorts', 'ElBorn']
INFO logger 2024-02-01 10:41:35,542 | train_utils.py:153 | Best Loss: 0.00034166935319814273
INFO logger 2024-02-01 10:41:37,071 | train_utils.py:153 | Best Loss: 9.913632492344195e-05
INFO logger 2024-02-01 10:41:37,875 | train_utils.py:153 | Best Loss: 8.823579668791757e-06
INFO logger 2024-02-01 10:41:37,972 | server.py:201 | [Global round 6] Aggregating local models...
INFO logger 2024-02-01 10:41:38,679 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['LesCorts', 'ElBorn', 'PobleSec']
INFO logger 2024-02-01 10:41:39,608 | train_utils.py:153 | Best Loss: 9.292016116962142e-05
INFO logger 2024-02-01 10:41:40,335 | train_utils.py:153 | Best Loss: 7.304368365740466e-06
INFO logger 2024-02-01 10:41:42,920 | train_utils.py:153 | Best Loss: 0.00034291804553647563
INFO logger 2024-02-01 10:41:43,274 | server.py:201 | [Global round 7] Aggregating local models...
INFO logger 2024-02-01 10:41:44,020 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['PobleSec', 'LesCorts', 'ElBorn']
INFO logger 2024-02-01 10:41:46,408 | train_utils.py:153 | Best Loss: 0.0003453163949655384
INFO logger 2024-02-01 10:41:49,402 | train_utils.py:153 | Best Loss: 9.213777991523694e-05
INFO logger 2024-02-01 10:41:50,224 | train_utils.py:153 | Best Loss: 7.2534179980281725e-06
INFO logger 2024-02-01 10:41:50,321 | server.py:201 | [Global round 8] Aggregating local models...
INFO logger 2024-02-01 10:41:51,037 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['PobleSec', 'ElBorn', 'LesCorts']
INFO logger 2024-02-01 10:41:53,401 | train_utils.py:153 | Best Loss: 0.0003465630452324614
INFO logger 2024-02-01 10:41:54,517 | train_utils.py:153 | Best Loss: 7.19392892498532e-06
INFO logger 2024-02-01 10:41:55,525 | train_utils.py:153 | Best Loss: 9.416682034327883e-05
INFO logger 2024-02-01 10:41:55,747 | server.py:201 | [Global round 9] Aggregating local models...
INFO logger 2024-02-01 10:41:56,297 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['LesCorts', 'PobleSec', 'ElBorn']
INFO logger 2024-02-01 10:41:57,306 | train_utils.py:153 | Best Loss: 9.38615710297545e-05
INFO logger 2024-02-01 10:42:00,598 | train_utils.py:153 | Best Loss: 0.0003466338718192666
INFO logger 2024-02-01 10:42:01,731 | train_utils.py:153 | Best Loss: 6.8002603208569695e-06
INFO logger 2024-02-01 10:42:01,829 | server.py:201 | [Global round 10] Aggregating local models...
INFO logger 2024-02-01 10:42:02,441 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['PobleSec', 'LesCorts', 'ElBorn']
INFO logger 2024-02-01 10:42:04,794 | train_utils.py:153 | Best Loss: 0.00034944669737693246
INFO logger 2024-02-01 10:42:06,157 | train_utils.py:153 | Best Loss: 9.21162892043133e-05
INFO logger 2024-02-01 10:42:06,992 | train_utils.py:153 | Best Loss: 7.296931352871268e-06
INFO logger 2024-02-01 10:42:07,091 | server.py:201 | [Global round 11] Aggregating local models...
INFO logger 2024-02-01 10:42:07,687 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['PobleSec', 'LesCorts', 'ElBorn']
INFO logger 2024-02-01 10:42:10,341 | train_utils.py:153 | Best Loss: 0.0003514694310101409
INFO logger 2024-02-01 10:42:12,523 | train_utils.py:153 | Best Loss: 9.06909978676217e-05
INFO logger 2024-02-01 10:42:13,324 | train_utils.py:153 | Best Loss: 6.8270634372768126e-06
INFO logger 2024-02-01 10:42:13,424 | server.py:201 | [Global round 12] Aggregating local models...
INFO logger 2024-02-01 10:42:14,141 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['PobleSec', 'ElBorn', 'LesCorts']
INFO logger 2024-02-01 10:42:16,497 | train_utils.py:153 | Best Loss: 0.0003526269831130002
INFO logger 2024-02-01 10:42:17,867 | train_utils.py:153 | Best Loss: 7.195922010128301e-06
INFO logger 2024-02-01 10:42:19,413 | train_utils.py:153 | Best Loss: 9.191923755035894e-05
INFO logger 2024-02-01 10:42:19,572 | server.py:201 | [Global round 13] Aggregating local models...
INFO logger 2024-02-01 10:42:20,300 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['PobleSec', 'LesCorts', 'ElBorn']
INFO logger 2024-02-01 10:42:22,648 | train_utils.py:153 | Best Loss: 0.00035416916219928253
INFO logger 2024-02-01 10:42:24,599 | train_utils.py:153 | Best Loss: 9.003247349517561e-05
INFO logger 2024-02-01 10:42:25,418 | train_utils.py:153 | Best Loss: 7.198669896787257e-06
INFO logger 2024-02-01 10:42:25,513 | server.py:201 | [Global round 14] Aggregating local models...
INFO logger 2024-02-01 10:42:26,280 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['PobleSec', 'LesCorts', 'ElBorn']
INFO logger 2024-02-01 10:42:29,309 | train_utils.py:153 | Best Loss: 0.0003555585167143406
INFO logger 2024-02-01 10:42:30,789 | train_utils.py:153 | Best Loss: 9.298444097883433e-05
INFO logger 2024-02-01 10:42:31,510 | train_utils.py:153 | Best Loss: 6.659883196782861e-06
INFO logger 2024-02-01 10:42:31,609 | server.py:201 | [Global round 15] Aggregating local models...
INFO logger 2024-02-01 10:42:32,368 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['ElBorn', 'LesCorts', 'PobleSec']
INFO logger 2024-02-01 10:42:32,993 | train_utils.py:153 | Best Loss: 6.782891098601105e-06
INFO logger 2024-02-01 10:42:34,198 | train_utils.py:153 | Best Loss: 9.06273726392973e-05
INFO logger 2024-02-01 10:42:36,594 | train_utils.py:153 | Best Loss: 0.0003563473766530299
INFO logger 2024-02-01 10:42:37,069 | server.py:201 | [Global round 16] Aggregating local models...
INFO logger 2024-02-01 10:42:37,663 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['ElBorn', 'PobleSec', 'LesCorts']
INFO logger 2024-02-01 10:42:38,356 | train_utils.py:153 | Best Loss: 6.534765829649363e-06
INFO logger 2024-02-01 10:42:41,014 | train_utils.py:153 | Best Loss: 0.0003578390778541037
INFO logger 2024-02-01 10:42:42,581 | train_utils.py:153 | Best Loss: 9.268655527481123e-05
INFO logger 2024-02-01 10:42:42,741 | server.py:201 | [Global round 17] Aggregating local models...
INFO logger 2024-02-01 10:42:43,353 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['ElBorn', 'LesCorts', 'PobleSec']
INFO logger 2024-02-01 10:42:44,037 | train_utils.py:153 | Best Loss: 6.694949621780087e-06
INFO logger 2024-02-01 10:42:45,027 | train_utils.py:153 | Best Loss: 9.063903714818825e-05
INFO logger 2024-02-01 10:42:47,626 | train_utils.py:153 | Best Loss: 0.0003591000243992083
INFO logger 2024-02-01 10:42:47,992 | server.py:201 | [Global round 18] Aggregating local models...
INFO logger 2024-02-01 10:42:48,718 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['ElBorn', 'LesCorts', 'PobleSec']
INFO logger 2024-02-01 10:42:49,295 | train_utils.py:153 | Best Loss: 6.633197585321009e-06
INFO logger 2024-02-01 10:42:51,105 | train_utils.py:153 | Best Loss: 9.104798613279535e-05
INFO logger 2024-02-01 10:42:53,655 | train_utils.py:153 | Best Loss: 0.0003598765585769525
INFO logger 2024-02-01 10:42:54,010 | server.py:201 | [Global round 19] Aggregating local models...
INFO logger 2024-02-01 10:42:54,824 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['ElBorn', 'LesCorts', 'PobleSec']
INFO logger 2024-02-01 10:42:55,468 | train_utils.py:153 | Best Loss: 6.645333425677269e-06
INFO logger 2024-02-01 10:42:56,763 | train_utils.py:153 | Best Loss: 8.960476309218995e-05
INFO logger 2024-02-01 10:42:59,400 | train_utils.py:153 | Best Loss: 0.0003611897816698206
INFO logger 2024-02-01 10:42:59,752 | server.py:201 | [Global round 20] Aggregating local models...
INFO logger 2024-02-01 10:43:00,482 | server.py:122 | Time passed: 117.72123265266418 seconds.
INFO logger 2024-02-01 10:43:00,483 | server.py:123 | Best global model found on fl_round=5 with loss=0.00024292953731154036
Traceback (most recent call last):
  File "/home/judy/code/Fed-Time-Series-Forecasting/main.py", line 118, in <module>
    main(args)
  File "/home/judy/code/Fed-Time-Series-Forecasting/main.py", line 55, in main
    validation_dict = inference(
                      ^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/fl_trainer.py", line 156, in inference
    num_lags=args.num_lags,
             ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'num_lags'