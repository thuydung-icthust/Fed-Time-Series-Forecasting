INFO logger 2024-02-01 10:32:08,295 | data_utils.py:383 | Observations info in ElBorn
INFO logger 2024-02-01 10:32:08,295 | data_utils.py:384 | 	Total number of samples:  4192
INFO logger 2024-02-01 10:32:08,295 | data_utils.py:385 | 	Number of samples for training: 3354
INFO logger 2024-02-01 10:32:08,295 | data_utils.py:386 | 	Number of samples for validation:  838
INFO logger 2024-02-01 10:32:08,298 | data_utils.py:383 | Observations info in LesCorts
INFO logger 2024-02-01 10:32:08,298 | data_utils.py:384 | 	Total number of samples:  6892
INFO logger 2024-02-01 10:32:08,298 | data_utils.py:385 | 	Number of samples for training: 5514
INFO logger 2024-02-01 10:32:08,298 | data_utils.py:386 | 	Number of samples for validation:  1378
INFO logger 2024-02-01 10:32:08,301 | data_utils.py:383 | Observations info in PobleSec
INFO logger 2024-02-01 10:32:08,301 | data_utils.py:384 | 	Total number of samples:  15927
INFO logger 2024-02-01 10:32:08,302 | data_utils.py:385 | 	Number of samples for training: 12742
INFO logger 2024-02-01 10:32:08,302 | data_utils.py:386 | 	Number of samples for validation:  3185
INFO logger 2024-02-01 10:32:08,303 | data_utils.py:389 | Observations info using all data
INFO logger 2024-02-01 10:32:08,303 | data_utils.py:390 | 	Total number of samples:  27011
INFO logger 2024-02-01 10:32:08,303 | data_utils.py:391 | 	Number of samples for training: 21610
INFO logger 2024-02-01 10:32:08,303 | data_utils.py:392 | 	Number of samples for validation:  5401
INFO logger 2024-02-01 10:32:08,304 | data_utils.py:118 | Using Flooring and Capping and with params: {'ElBorn': (10, 90), 'LesCorts': (10, 90), 'PobleSec': (5, 95)}
INFO logger 2024-02-01 10:32:09,056 | server.py:62 | Initializing client manager...
INFO logger 2024-02-01 10:32:09,056 | server.py:69 | Registering clients...
INFO logger 2024-02-01 10:32:09,057 | client_manager.py:66 | Registered client with id: ElBorn
INFO logger 2024-02-01 10:32:09,057 | client_manager.py:66 | Registered client with id: LesCorts
INFO logger 2024-02-01 10:32:09,057 | client_manager.py:66 | Registered client with id: PobleSec
INFO logger 2024-02-01 10:32:09,057 | server.py:73 | Client manager initialized!
INFO logger 2024-02-01 10:32:09,058 | server.py:55 | Aggregation algorithm: FedAvg()
INFO logger 2024-02-01 10:32:09,058 | client_manager.py:88 | Parameter c=0.0. Sampled 1 client(s): ['LesCorts']
Clients participating training are: dict_keys(['ElBorn', 'LesCorts', 'PobleSec'])
INFO logger 2024-02-01 10:32:09,921 | server.py:87 | Starting FL rounds
INFO logger 2024-02-01 10:32:09,921 | client_manager.py:88 | Parameter c=1.0. Sampled 3 client(s): ['LesCorts', 'ElBorn', 'PobleSec']
INFO logger 2024-02-01 10:32:11,436 | train_utils.py:153 | Best Loss: 9.611116624192188e-05
INFO logger 2024-02-01 10:32:12,925 | train_utils.py:153 | Best Loss: 1.827523342596934e-05
INFO logger 2024-02-01 10:32:15,738 | train_utils.py:153 | Best Loss: 0.00035936859661830575
INFO logger 2024-02-01 10:32:16,091 | server.py:201 | [Global round 1] Aggregating local models...
Traceback (most recent call last):
  File "/home/judy/code/Fed-Time-Series-Forecasting/main.py", line 116, in <module>
    main(args)
  File "/home/judy/code/Fed-Time-Series-Forecasting/main.py", line 46, in main
    global_model, history = fit(
                            ^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/fl_trainer.py", line 109, in fit
    model_params, history = server.fit(args.fl_rounds, args.fraction, use_carbontracker=use_carbontracker,
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/judy/code/Fed-Time-Series-Forecasting/ml/fl/server/server.py", line 112, in fit
    wandb_ins.log({f"{key_}/val_mse": test_metrics[key_]['MSE'],
    ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'log'